<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>WF Helper Pro</title>
    <!-- Font Awesome CDN for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Google Fonts for a modern, premium look (e.g., Poppins, Montserrat) -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* CSS Variables for easy theming - TikTok Premium Inspired */
        :root {
            --primary-color: #00E6FF; /* Electric Blue - vibrant and modern, slightly neon */
            --primary-dark: #00B8D4; /* Slightly darker electric blue */
            --secondary-color: #FF0050; /* TikTok Pink/Magenta - for contrast/accents */
            --secondary-light: #FF4081; /* Lighter secondary for subtle glows */
            --danger-color: #FF4D4D; /* Brighter Red for danger */
            --background-gradient-start: #0A0A0A; /* Deeper dark */
            --background-gradient-mid: #121212;
            --background-gradient-end: #1A1A1A;
            --card-background: rgba(255, 255, 255, 0.08); /* Frosted glass effect */
            --card-background-hover: rgba(255, 255, 255, 0.15);
            --card-border: rgba(255, 255, 255, 0.15);
            --text-color: #E0E0E0; /* Light grey for readability */
            --text-light: #B0B0B0;
            --input-background: rgba(0, 0, 0, 0.2); /* Darker input background */
            --input-border: rgba(255, 255, 255, 0.2);
            --input-focus-background: rgba(0, 0, 0, 0.4);
            --shadow-light: rgba(0, 0, 0, 0.5);
            --shadow-medium: rgba(0, 0, 0, 0.7);
            --shadow-heavy: rgba(0, 0, 0, 0.9);
            --border-radius-small: 12px;
            --border-radius-medium: 18px;
            --border-radius-large: 35px;
            --font-primary: 'Poppins', sans-serif;
            --font-secondary: 'Montserrat', sans-serif;

            /* Helper for RGB values for rgba() */
            --primary-color-rgb: 0, 230, 255; /* 00E6FF */
            --secondary-color-rgb: 255, 0, 80; /* FF0050 */
            --danger-color-rgb: 255, 77, 77; /* FF4D4D */
        }

        /* Global Styles */
        *, *::before, *::after {
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-primary);
            background: linear-gradient(135deg, var(--background-gradient-start), var(--background-gradient-mid), var(--background-gradient-end));
            margin: 0;
            padding: 25px;
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
            position: relative;
            line-height: 1.6;
            background-attachment: fixed; /* Ensures gradient stays fixed */
        }

        /* Typography */
        h1 {
            font-family: var(--font-secondary);
            color: var(--primary-color);
            margin-bottom: 40px;
            text-shadow: 0 0 30px var(--primary-color), 0 0 20px var(--shadow-heavy);
            font-size: 5em; /* Even larger */
            letter-spacing: 5px;
            text-align: center;
            width: 100%;
            font-weight: 700;
            animation: fadeInDown 1.2s ease-out;
            position: relative;
            padding-bottom: 15px;
        }

        h1::after {
            content: '';
            position: absolute;
            left: 50%;
            bottom: 0;
            transform: translateX(-50%);
            width: 100px;
            height: 5px;
            background: linear-gradient(90deg, transparent, var(--secondary-color), transparent);
            border-radius: 3px;
            box-shadow: 0 0 15px var(--secondary-color);
        }

        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h2, h3, h4, h5 {
            font-family: var(--font-secondary);
            color: var(--text-color);
            font-weight: 600;
            margin-top: 30px;
            margin-bottom: 18px;
        }

        /* Tabs Navigation */
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 50px;
            flex-wrap: wrap;
            width: 100%;
            max-width: 800px; /* Wider tabs */
            gap: 20px; /* More space between tabs */
        }

        .tab {
            padding: 16px 35px;
            cursor: pointer;
            background: var(--card-background);
            border: 1px solid var(--card-border);
            border-radius: var(--border-radius-medium);
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); /* Smoother transition */
            flex-grow: 1;
            text-align: center;
            min-width: 180px;
            font-weight: 600;
            font-size: 1.2em;
            box-shadow: 0 8px 25px var(--shadow-light);
            position: relative;
            overflow: hidden;
            color: var(--text-light);
            backdrop-filter: blur(8px); /* Frosted glass for tabs */
        }

        .tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: all 0.7s ease-out;
        }

        .tab:hover::before {
            left: 100%;
        }

        .tab:hover {
            background: var(--card-background-hover);
            transform: translateY(-7px) scale(1.04);
            box-shadow: 0 12px 35px var(--shadow-medium);
            border-color: var(--primary-color);
            color: var(--primary-color); /* Text color changes to primary on hover */
        }

        .tab.active {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color)); /* Gradient for active tab */
            color: #0A0A0A; /* Dark text on vibrant background */
            box-shadow: 0 10px 30px rgba(var(--primary-color-rgb), 0.6), 0 0 20px var(--secondary-color);
            transform: translateY(-5px);
            border-color: var(--primary-color);
            font-weight: 700;
        }

        /* Main Content Container */
        .container {
            background: var(--card-background);
            backdrop-filter: blur(20px); /* Stronger blur for main container */
            border-radius: var(--border-radius-large);
            box-shadow: 0 25px 60px var(--shadow-heavy);
            padding: 50px 60px;
            max-width: 800px; /* Wider container */
            width: 100%;
            transition: transform 0.7s cubic-bezier(0.25, 0.8, 0.25, 1), opacity 0.7s ease-out;
            margin: 0 auto 50px auto;
            border: 1px solid var(--card-border);
            position: relative;
            overflow: hidden;
        }

        .container::before {
            content: '';
            position: absolute;
            top: -60%;
            left: -60%;
            width: 220%;
            height: 220%;
            background: radial-gradient(circle at 50% 50%, rgba(var(--primary-color-rgb), 0.08), transparent 75%);
            animation: subtleGlow 18s infinite alternate ease-in-out;
            z-index: -1;
        }

        @keyframes subtleGlow {
            0% { transform: scale(1); opacity: 0.1; }
            50% { transform: scale(1.15); opacity: 0.18; }
            100% { transform: scale(1); opacity: 0.1; }
        }

        /* Form Elements */
        label {
            font-weight: 600;
            margin-top: 30px;
            display: block;
            color: var(--primary-color); /* Vibrant label color */
            font-size: 1.35em;
            margin-bottom: 12px;
            text-shadow: 0 0 8px rgba(var(--primary-color-rgb), 0.4);
        }

        textarea, input, select {
            width: 100%;
            padding: 18px;
            border-radius: var(--border-radius-medium);
            border: 1px solid var(--input-border);
            font-size: 1.15em;
            background: var(--input-background);
            color: var(--text-color);
            transition: all 0.35s ease;
            box-shadow: inset 0 3px 10px var(--shadow-light);
            font-family: var(--font-primary);
        }

        textarea:focus, input:focus, select:focus {
            border-color: var(--primary-color);
            background: var(--input-focus-background);
            outline: none;
            box-shadow: 0 0 0 5px rgba(var(--primary-color-rgb), 0.4), inset 0 3px 12px var(--shadow-medium);
        }

        select {
            color: var(--text-color);
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%2300E6FF%22%20d%3D%22M287%2C114.7L159.7%2C242c-3.2%2C3.2-8.3%2C3.2-11.5%2C0L5.4%2C114.7c-3.2-3.2-3.2-8.3%2C0-11.5l11.5-11.5c3.2-3.2%2C8.3-3.2%2C11.5%2C0l115.5%2C115.5l115.5-115.5c3.2-3.2%2C8.3-3.2%2C11.5%2C0l11.5%2C11.5C290.2%2C106.4%2C290.2%2C111.5%2C287%2C114.7z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 20px center;
            background-size: 16px;
            padding-right: 50px;
        }

        option {
            background-color: var(--background-gradient-mid);
            color: var(--text-color);
        }

        ::placeholder {
            color: var(--text-light);
            opacity: 0.8;
        }

        /* Main Buttons */
        button {
            margin-top: 40px;
            padding: 20px 45px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color)); /* Gradient button */
            color: #0A0A0A;
            border: none;
            border-radius: var(--border-radius-medium);
            font-size: 1.4em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 12px 35px rgba(var(--primary-color-rgb), 0.5), 0 0 20px var(--secondary-color);
            width: 100%;
            max-width: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            letter-spacing: 0.8px;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        button i {
            margin-right: 12px;
            font-size: 1.15em;
            color: #0A0A0A; /* Icon color matches button text */
        }

        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0.0) 100%);
            transform: translateX(-100%);
            transition: transform 0.6s ease-out;
            z-index: -1;
        }

        button:hover::before {
            transform: translateX(0%);
        }

        button:hover {
            background: linear-gradient(45deg, var(--primary-dark), var(--secondary-light)); /* Slightly shifted gradient on hover */
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 18px 45px rgba(var(--primary-color-rgb), 0.7), 0 0 25px var(--secondary-light);
            color: #fff; /* Text color might lighten on hover */
        }

        button:active {
            transform: translateY(0);
            box-shadow: 0 10px 25px var(--shadow-medium);
        }

        /* Results Area */
        .results {
            margin-top: 50px;
            width: 100%;
        }

        .agent-block {
            background: var(--card-background);
            padding: 25px;
            margin-bottom: 20px;
            border-left: 8px solid var(--primary-color); /* Thicker, more prominent border */
            border-radius: var(--border-radius-medium);
            box-shadow: 0 10px 25px var(--shadow-light);
            transition: all 0.35s ease;
            position: relative;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
            overflow: hidden;
            border-top: 1px solid var(--card-border);
            border-right: 1px solid var(--card-border);
            border-bottom: 1px solid var(--card-border);
            backdrop-filter: blur(5px);
        }

        .agent-block::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 15% 15%, rgba(var(--primary-color-rgb),0.2), transparent 70%);
            opacity: 0;
            transition: opacity 0.7s ease;
            pointer-events: none;
        }

        .agent-block:hover::before {
            opacity: 1;
        }

        .agent-block:hover {
            transform: translateY(-6px) scale(1.02);
            box-shadow: 0 15px 30px var(--shadow-medium);
            border-left-color: var(--secondary-color); /* Border changes color on hover */
        }

        .agent-block strong {
            color: var(--primary-color);
            font-size: 1.5em;
            flex-basis: 100%;
            margin-bottom: 12px;
            font-weight: 700;
            font-family: var(--font-secondary);
            text-shadow: 0 0 5px rgba(var(--primary-color-rgb), 0.3);
        }

        .agent-block span {
            flex-grow: 1;
            margin-right: 25px;
            font-size: 1.15em;
            color: var(--text-light);
        }

        /* Action Buttons within Agent Blocks */
        .edit-button, .delete-button, .done-button {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--card-border);
            color: var(--primary-color);
            cursor: pointer;
            font-size: 1.4em;
            margin-left: 12px;
            padding: 12px;
            border-radius: var(--border-radius-small);
            transition: all 0.35s ease;
            position: relative;
            overflow: hidden;
            z-index: 1;
            flex-shrink: 0;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            box-shadow: 0 5px 15px var(--shadow-light);
        }

        .edit-button::before, .delete-button::before, .done-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.0) 100%);
            transform: translateX(-100%);
            transition: transform 0.6s ease-out;
            z-index: -1;
        }

        .edit-button:hover::before, .delete-button:hover::before, .done-button:hover::before {
            transform: translateX(0%);
        }

        .edit-button:hover {
            background-color: rgba(var(--primary-color-rgb), 0.3);
            border-color: var(--primary-color);
            box-shadow: 0 10px 25px rgba(var(--primary-color-rgb), 0.5);
            transform: translateY(-4px) scale(1.15);
            color: #fff;
        }

        .delete-button {
            color: var(--danger-color);
        }

        .delete-button:hover {
            background-color: rgba(var(--danger-color-rgb), 0.3);
            border-color: var(--danger-color);
            box-shadow: 0 10px 25px rgba(var(--danger-color-rgb), 0.5);
            transform: translateY(-4px) scale(1.15);
            color: #fff;
        }

        .done-button {
            color: var(--secondary-color);
        }

        .done-button:hover {
            background-color: rgba(var(--secondary-color-rgb), 0.3);
            border-color: var(--secondary-color);
            box-shadow: 0 10px 25px rgba(var(--secondary-color-rgb), 0.5);
            transform: translateY(-4px) scale(1.15);
            color: #fff;
        }

        /* Report Output */
        .report-output {
            background: var(--input-background);
            padding: 30px;
            border-radius: var(--border-radius-medium);
            margin-top: 40px;
            white-space: pre-wrap;
            word-wrap: break-word;
            border: 1px solid var(--input-border);
            box-shadow: 0 8px 20px var(--shadow-light);
            line-height: 1.8;
            font-size: 1.1em;
            font-family: 'Fira Code', 'Consolas', monospace; /* Monospace for code-like output */
            color: var(--text-color);
            backdrop-filter: blur(5px);
        }

        /* Expectations Message */
        .expectations-message {
            margin-top: 35px;
            padding: 25px;
            background: rgba(var(--primary-color-rgb), 0.15);
            border-left: 8px solid var(--primary-color);
            border-radius: var(--border-radius-medium);
            color: var(--text-color);
            font-size: 1.2em;
            line-height: 1.8;
            box-shadow: 0 5px 18px var(--shadow-light);
            backdrop-filter: blur(5px);
        }

        .expectations-message strong {
            color: var(--primary-color);
            font-size: 1.15em;
            font-weight: 700;
            text-shadow: 0 0 5px rgba(var(--primary-color-rgb), 0.3);
        }

        .expectations-message ul {
            list-style: none;
            padding: 0;
            margin-top: 15px;
        }

        .expectations-message li {
            padding: 8px 0;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.2);
            color: var(--text-light);
        }

        .expectations-message li:last-child {
            border-bottom: none;
        }

        /* Collapsible Sections */
        .schedule-section {
            margin-top: 35px;
            border: 1px solid var(--card-border);
            border-radius: var(--border-radius-medium);
            overflow: hidden;
            box-shadow: 0 12px 35px var(--shadow-medium);
            background: var(--card-background);
            transition: all 0.45s ease;
            backdrop-filter: blur(8px);
        }

        .schedule-section:hover {
            transform: translateY(-6px);
            box-shadow: 0 18px 50px var(--shadow-heavy);
        }

        .schedule-header {
            background: linear-gradient(90deg, rgba(var(--primary-color-rgb), 0.2), rgba(var(--secondary-color-rgb), 0.1));
            padding: 22px 30px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 700;
            font-size: 1.6em;
            color: var(--text-color);
            border-bottom: 1px solid rgba(var(--primary-color-rgb), 0.4);
            transition: background 0.35s ease;
            font-family: var(--font-secondary);
            text-shadow: 0 0 10px rgba(var(--primary-color-rgb), 0.3);
        }

        .schedule-header:hover {
            background: linear-gradient(90deg, rgba(var(--primary-color-rgb), 0.3), rgba(var(--secondary-color-rgb), 0.2));
        }

        .schedule-header i {
            transition: transform 0.45s ease;
            font-size: 1em;
            color: var(--secondary-color);
        }

        .schedule-header.hidden-content i {
            transform: rotate(-90deg);
        }

        .schedule-content {
            padding: 0 30px;
            overflow-y: auto;
            max-height: 0;
            transition: max-height 0.7s ease-out, padding 0.7s ease-out;
            will-change: max-height;
        }

        .schedule-content.expanded {
            max-height: 700px; /* Increased for more content */
            padding: 30px 30px;
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            display: flex;
            flex-direction: column-reverse;
            gap: 15px;
        }

        .toast {
            background-color: rgba(15, 15, 15, 0.98);
            color: var(--text-color);
            padding: 20px 28px;
            border-radius: var(--border-radius-medium);
            box-shadow: 0 10px 25px var(--shadow-heavy);
            display: flex;
            align-items: center;
            gap: 15px;
            opacity: 0;
            transform: translateY(30px);
            animation: toastIn 0.5s forwards, toastOut 0.5s forwards 3s;
            min-width: 300px;
            max-width: 400px;
            border-left: 8px solid var(--primary-color);
            font-size: 1.1em;
            backdrop-filter: blur(10px);
        }

        .toast.success { border-left-color: var(--primary-color); } /* Changed to primary for success */
        .toast.error { border-left-color: var(--danger-color); }
        .toast.info { border-left-color: var(--secondary-color); } /* Changed to secondary for info */

        .toast.break-alarm {
            background-color: rgba(255, 100, 0, 0.98); /* Brighter orange */
            color: #0A0A0A;
            border-left-color: #FF4500;
            box-shadow: 0 12px 35px rgba(255, 100, 0, 0.8);
            font-weight: 700;
            animation: toastIn 0.5s forwards, toastOut 0.5s forwards 8s;
            transform: scale(1.08);
        }

        .toast.break-alarm i {
            color: #FF4500;
            font-size: 1.3em;
        }

        @keyframes toastIn {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes toastOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(40px); }
        }

        /* New styles for compact report input fields */
        .report-input-grid {
            display: grid;
            grid-template-columns: 1fr minmax(70px, 130px);
            gap: 15px 30px;
            align-items: center;
            margin-top: 30px;
        }

        .report-input-grid .form-group-inline {
            display: contents;
        }

        .report-input-grid label {
            margin-top: 0;
            margin-bottom: 0;
            font-size: 1.2em;
            text-align: left;
            white-space: nowrap;
            padding-right: 15px;
            color: var(--text-color); /* Less vibrant for grid labels */
            text-shadow: none;
        }

        .report-input-grid input[type="number"] {
            width: 100%;
            max-width: 130px;
            text-align: center;
            padding: 12px 18px;
            font-size: 1.1em;
            justify-self: end;
        }

        /* Attendance Status Specific Styles */
        .attendance-entry {
            background: var(--card-background);
            padding: 20px;
            margin-bottom: 15px;
            border-left: 8px solid var(--primary-color); /* Use primary color for attendance */
            border-radius: var(--border-radius-medium);
            box-shadow: 0 8px 20px var(--shadow-light);
            transition: all 0.35s ease;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
            border-top: 1px solid var(--card-border);
            border-right: 1px solid var(--card-border);
            border-bottom: 1px solid var(--card-border);
            backdrop-filter: blur(5px);
        }

        .attendance-entry strong {
            color: var(--primary-color);
            font-size: 1.3em;
            flex-basis: auto;
            margin-right: 20px;
            flex-grow: 1;
            word-wrap: break-word;
            font-family: var(--font-secondary);
            text-shadow: 0 0 5px rgba(var(--primary-color-rgb), 0.3);
        }

        .attendance-entry .actions {
            display: flex;
            gap: 10px;
            flex-shrink: 0;
        }

        .attendance-entry .actions button {
            margin-top: 0;
            padding: 10px 18px;
            font-size: 1.1em;
            max-width: unset;
            width: auto;
            box-shadow: none;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--card-border);
            color: var(--danger-color);
        }
        .attendance-entry .actions button:hover {
            background-color: rgba(var(--danger-color-rgb), 0.3);
            border-color: var(--danger-color);
            box-shadow: 0 6px 15px rgba(var(--danger-color-rgb), 0.4);
            transform: translateY(-3px) scale(1.08);
            color: #fff;
        }


        .attendance-entry select,
        .attendance-entry input[type="time"] {
            width: auto;
            max-width: 220px;
            margin-right: 15px;
            padding: 12px 18px;
            font-size: 1.05em;
            background-position: right 12px center;
            padding-right: 40px;
            flex-shrink: 0;
        }

        /* New style for break separators */
        .break-separator {
            margin-top: 35px;
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
            color: var(--primary-color);
            font-size: 1.4em;
            font-weight: 700;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 1.8px;
            font-family: var(--font-secondary);
            text-shadow: 0 0 10px rgba(var(--primary-color-rgb), 0.3);
        }

        /* Media Queries for Responsiveness */
        @media (max-width: 768px) {
            body {
                padding: 20px;
            }

            h1 {
                font-size: 4em;
                margin-bottom: 30px;
            }

            .container {
                padding: 40px 45px;
                border-radius: var(--border-radius-large);
            }

            .tabs {
                flex-direction: column;
                align-items: stretch;
                max-width: 100%;
            }

            .tab {
                margin: 10px 0;
                padding: 18px 30px;
                min-width: unset;
                font-size: 1.1em;
            }

            button {
                font-size: 1.3em;
                padding: 18px 35px;
                max-width: 100%;
            }

            .agent-block {
                flex-direction: column;
                align-items: flex-start;
                padding: 20px;
            }

            .agent-block strong {
                font-size: 1.4em;
                margin-bottom: 10px;
            }

            .agent-block span {
                margin-right: 0;
                margin-bottom: 15px;
            }

            .edit-button, .delete-button, .done-button {
                width: 45px;
                height: 45px;
                font-size: 1.3em;
                padding: 10px;
                margin-left: 0;
                margin-top: 12px;
            }

            .schedule-header {
                font-size: 1.4em;
                padding: 20px 28px;
            }

            .schedule-content.expanded {
                padding: 25px 28px;
            }

            .toast-container {
                bottom: 20px;
                right: 20px;
                left: 20px;
                flex-direction: column;
            }

            .toast {
                min-width: unset;
                max-width: unset;
                width: auto;
            }

            .report-input-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .report-input-grid label {
                text-align: left;
                padding-right: 0;
            }

            .report-input-grid input[type="number"] {
                max-width: 100%;
                justify-self: stretch;
            }

            .attendance-entry {
                flex-direction: column;
                align-items: flex-start;
            }
            .attendance-entry strong {
                margin-bottom: 10px;
            }
            .attendance-entry .actions {
                width: 100%;
                justify-content: flex-end;
            }
            .attendance-entry select,
            .attendance-entry input[type="time"] {
                width: 100%;
                max-width: unset;
                margin-right: 0;
                margin-bottom: 15px;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 3.2em;
                letter-spacing: 3px;
            }

            .container {
                padding: 35px 30px;
            }

            label {
                font-size: 1.2em;
            }

            textarea, input, select {
                padding: 16px;
                font-size: 1.05em;
            }

            button {
                font-size: 1.2em;
                padding: 16px 30px;
            }

            .edit-button, .delete-button, .done-button {
                width: 40px;
                height: 40px;
                font-size: 1.2em;
                padding: 8px;
            }

            .expectations-message {
                font-size: 1.1em;
                padding: 20px;
            }

            .report-output {
                font-size: 1em;
                padding: 25px;
            }
        }

        /* Additional responsiveness for form elements and buttons */
        @media (max-width: 600px) {
            textarea, input[type="text"], input[type="number"], input[type="time"], select {
                width: 100%;
                min-width: unset;
            }

            button {
                max-width: 100%;
                padding: 17px 30px;
                font-size: 1.25em;
            }

            label {
                margin-top: 25px;
                margin-bottom: 10px;
            }

            .report-input-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .report-input-grid label {
                text-align: left;
                padding-right: 0;
            }

            .report-input-grid input[type="number"] {
                max-width: 100%;
                text-align: left;
            }
        }
        /* Styles for the new Switch Template tab */
        .template-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .template-buttons button {
            margin-top: 0;
            padding: 18px 28px;
            font-size: 1.15em;
            max-width: unset;
            box-shadow: 0 8px 25px var(--shadow-light);
            background-color: var(--card-background);
            border: 1px solid var(--card-border);
            color: var(--text-color);
            backdrop-filter: blur(5px);
        }
        .template-buttons button:hover {
            background-color: var(--card-background-hover);
            border-color: var(--primary-color);
            box-shadow: 0 10px 30px var(--shadow-medium);
            color: var(--primary-color);
        }
        .template-buttons button i {
            color: var(--secondary-color);
            transition: color 0.3s ease;
        }
        .template-buttons button:hover i {
            color: var(--primary-color);
        }


        /* Styles for Agent Configuration Tab */
        .agent-config-entry {
            background: var(--card-background);
            padding: 22px;
            margin-bottom: 18px;
            border-left: 8px solid var(--primary-color); /* Changed to primary blue */
            border-radius: var(--border-radius-medium);
            box-shadow: 0 8px 20px var(--shadow-light);
            display: flex;
            flex-direction: column;
            gap: 15px;
            border-top: 1px solid var(--card-border);
            border-right: 1px solid var(--card-border);
            border-bottom: 1px solid var(--card-border);
            backdrop-filter: blur(5px);
        }

        .agent-config-entry strong {
            color: var(--primary-color); /* Changed to primary blue */
            font-size: 1.35em;
            margin-bottom: 10px;
            word-break: break-word;
            flex-grow: 1;
            font-family: var(--font-secondary);
            text-shadow: 0 0 5px rgba(var(--primary-color-rgb), 0.3);
        }

        .agent-config-entry .break-slot-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            padding: 10px 0;
            border-top: 1px dashed rgba(255, 255, 255, 0.2);
            position: relative;
        }

        .agent-config-entry .break-slot-container:first-of-type {
            border-top: none;
        }

        .agent-config-entry .break-slot-container select,
        .agent-config-entry .break-slot-container input[type="text"] {
            flex-grow: 1;
            min-width: 120px;
            max-width: 200px;
            padding: 12px 18px;
            font-size: 1.05em;
            margin-top: 0;
        }

        .agent-config-entry .break-slot-container .remove-slot-button {
            margin-top: 0;
            padding: 10px 18px;
            font-size: 1.1em;
            max-width: unset;
            width: auto;
            box-shadow: none;
            background-color: var(--danger-color);
            color: #fff;
            border: none;
            border-radius: var(--border-radius-small);
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        .agent-config-entry .break-slot-container .remove-slot-button:hover {
            background-color: #d32f2f;
            transform: scale(1.08);
        }

        .agent-config-entry .add-slot-button {
            margin-top: 18px;
            padding: 12px 20px;
            font-size: 1.1em;
            max-width: 240px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color)); /* Gradient button */
            color: #0A0A0A;
            box-shadow: 0 8px 25px rgba(var(--primary-color-rgb), 0.5);
            font-weight: 600;
        }
        .agent-config-entry .add-slot-button:hover {
            background: linear-gradient(45deg, var(--primary-dark), var(--secondary-light)); /* Slightly shifted gradient on hover */
            box-shadow: 0 10px 30px rgba(var(--primary-color-rgb), 0.7);
            color: #fff;
        }

        .agent-config-entry .actions {
            display: flex;
            justify-content: flex-end;
            margin-top: 18px;
        }

        .agent-config-entry .actions button {
            margin-top: 0;
            padding: 10px 18px;
            font-size: 1.1em;
            max-width: unset;
            width: auto;
            box-shadow: none;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--card-border);
            color: var(--danger-color);
        }
        .agent-config-entry .actions button:hover {
            background-color: rgba(var(--danger-color-rgb), 0.3);
            border-color: var(--danger-color);
            box-shadow: 0 6px 15px rgba(var(--danger-color-rgb), 0.4);
            transform: translateY(-3px) scale(1.08);
            color: #fff;
        }

        /* Responsive adjustments for agent config */
        @media (max-width: 768px) {
            .agent-config-entry {
                padding: 18px;
            }
            .agent-config-entry .break-slot-container {
                flex-direction: column;
                align-items: stretch;
            }
            .agent-config-entry .break-slot-container select,
            .agent-config-entry .break-slot-container input[type="text"] {
                width: 100%;
                max-width: unset;
            }
            .agent-config-entry .add-slot-button {
                width: 100%;
                max-width: unset;
            }
            .agent-config-entry .actions {
                width: 100%;
                justify-content: flex-end;
            }
        }

        /* Specific styles for Switch Template buttons to ensure consistent sizing */
        .template-buttons button {
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            min-height: 60px;
        }

        .template-buttons button i {
            margin-right: 12px;
        }

        /* Styles for Backlog Template */
        .backlog-output {
            background: var(--input-background);
            padding: 30px;
            border-radius: var(--border-radius-medium);
            margin-top: 40px;
            white-space: pre-wrap;
            word-wrap: break-word;
            border: 1px solid var(--input-border);
            box-shadow: 0 8px 20px var(--shadow-light);
            line-height: 1.8;
            font-size: 1.1em;
            color: var(--text-color);
            backdrop-filter: blur(5px);
        }

        .backlog-output h3 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 30px;
            font-size: 1.5em;
            text-shadow: 0 0 8px rgba(var(--primary-color-rgb), 0.3);
        }

        .backlog-output p {
            margin-bottom: 15px;
            color: var(--text-light);
        }

        .backlog-time-input-group {
            display: flex;
            align-items: center;
            margin-bottom: 18px;
            gap: 15px;
        }

        .backlog-time-input-group label {
            margin: 0;
            min-width: 100px;
            font-size: 1.15em;
            color: var(--text-color);
            text-shadow: none;
        }

        .backlog-time-input-group input[type="number"] {
            width: 90px;
            padding: 12px 18px;
            font-size: 1.1em;
            text-align: center;
            margin-top: 0;
        }

        .backlog-time-input-group span {
            font-size: 1.15em;
            color: var(--text-light);
        }

        /* New styles for attendance report output */
        .attendance-report-output-container {
            background: var(--input-background);
            padding: 30px;
            border-radius: var(--border-radius-medium);
            margin-top: 40px;
            border: 1px solid var(--input-border);
            box-shadow: 0 8px 20px var(--shadow-light);
            line-height: 1.8;
            font-size: 1.1em;
            color: var(--text-color);
            backdrop-filter: blur(5px);
        }

        .attendance-report-output-container h4 {
            color: var(--primary-color); /* Changed to primary blue */
            margin-top: 20px;
            margin-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            padding-bottom: 10px;
            font-size: 1.4em;
            text-shadow: 0 0 5px rgba(var(--primary-color-rgb), 0.3);
        }
        .attendance-report-output-container h5 {
            color: var(--primary-color);
            margin-top: 18px;
            margin-bottom: 12px;
            font-size: 1.2em;
            text-shadow: 0 0 3px rgba(var(--primary-color-rgb), 0.2);
        }

        .attendance-report-output-container ul {
            list-style: disc;
            margin-left: 30px;
            padding: 0;
            color: var(--text-light);
        }

        .attendance-report-output-container ul ul {
            list-style: circle;
            margin-left: 30px;
            padding: 0;
            margin-top: 10px;
        }

        .attendance-report-output-container li {
            margin-bottom: 8px;
            word-wrap: break-word;
            white-space: normal;
        }

        /* Clear All Data Button */
        .clear-all-button {
            background-color: var(--danger-color);
            box-shadow: 0 12px 35px rgba(var(--danger-color-rgb), 0.6);
            margin-top: 70px;
            margin-bottom: 40px;
        }

        .clear-all-button:hover {
            background-color: #d32f2f;
            box-shadow: 0 18px 45px rgba(var(--danger-color-rgb), 0.8);
        }

        /* New styles for nested tabs */
        .nested-tabs {
            display: flex;
            justify-content: center;
            margin-top: 25px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            width: 100%;
            max-width: 700px;
            gap: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            padding-bottom: 15px;
        }

        .nested-tab {
            padding: 12px 20px;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(var(--primary-color-rgb), 0.4);
            border-radius: var(--border-radius-small);
            transition: all 0.3s ease-in-out;
            font-size: 1.05em;
            font-weight: 500;
            color: var(--text-light);
            flex-grow: 1;
            text-align: center;
            min-width: 120px;
            backdrop-filter: blur(5px);
        }

        .nested-tab:hover {
            background: rgba(var(--primary-color-rgb), 0.15);
            border-color: var(--primary-color);
            transform: translateY(-4px);
            box-shadow: 0 6px 15px var(--shadow-light);
            color: var(--text-color);
        }

        .nested-tab.active {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: #0A0A0A;
            border-color: var(--primary-color);
            box-shadow: 0 8px 20px rgba(var(--primary-color-rgb), 0.5);
            transform: translateY(-3px);
            font-weight: 600;
        }
    </style>
</head>
<body>

    <h1>WF Helper <span style="font-size: 0.6em; vertical-align: super; font-weight: normal;">PRO</span></h1>
    <div class="tabs">
        <div class="tab active" onclick="showMainTab('activities')">Activities</div>
        <div class="tab" onclick="showMainTab('reporting')">Reporting</div>
    </div>

    <!-- Main Activities Container -->
    <div class="container" id="activities" style="display: block;">
        <div class="nested-tabs">
            <div class="nested-tab active" onclick="showNestedTab('tasks')">IM Tasks</div>
            <div class="nested-tab" onclick="showNestedTab('agentConfig')">Break Schedule</div>
            <div class="nested-tab" onclick="showNestedTab('switchTemplate')">Switch Template</div>
        </div>

        <!-- IM Tasks Content -->
        <div id="tasks-content">
            <label for="agents">Enter Agent Names with Break Times (one per line, format: Name, Break Time):</label>
            <textarea id="agents" rows="6" placeholder="e.g. John Doe, 10:00&#10;Jane Smith, 10:15&#10;Alex Johnson, 09:45"></textarea>

            <label for="taskCount">Enter Total IM Task Volume:</label>
            <input type="number" id="taskCount" min="1" placeholder="e.g. 12" />

            <label for="shiftSchedule">Select Shift Schedule:</label>
            <select id="shiftSchedule">
                <option value="8PM">8:00 PM</option>
                <option value="10PM">10:00 PM</option>
                <option value="10:30PM">10:30 PM</option>
                <option value="3AM">3:00 AM</option>
                <option value="5AM">5:00 AM</option>
            </select>

            <button onclick="generateSkills()"><i class="fas fa-users-gear"></i> Generate IM Assignment</button>

            <div class="results" id="results"></div>
        </div>

        <!-- Break Schedule Content -->
        <div id="agentConfig-content" style="display: none;">
            <label for="agentConfigNames">Enter Agent Name(s) (one per line):</label>
            <textarea id="agentConfigNames" rows="6" placeholder="e.g. John Doe&#10;Jane Smith&#10;Alex Johnson"></textarea>
            <button onclick="addAgentConfigEntries()"><i class="fas fa-user-plus"></i> Add Agent(s)</button>

            <div class="results" id="agentConfigResults">
                <!-- Agent configuration entries will be dynamically added here -->
            </div>
        </div>

        <!-- Switch Template Content -->
        <div id="switchTemplate-content" style="display: none;">
            <label>Select a template to generate:</label>
            <div class="template-buttons">
                <button onclick="generateSwitchTemplate('IM')"><i class="fas fa-comment-dots"></i> IM</button>
                <button onclick="generateSwitchTemplate('Ticket')"><i class="fas fa-ticket-alt"></i> Ticket</button>
                <button onclick="generateSwitchTemplate('Break')"><i class="fas fa-coffee"></i> Break</button>
                <button onclick="generateSwitchTemplate('Lunch')"><i class="fas fa-utensils"></i> Lunch</button>
            </div>
            <div class="report-output" id="switchTemplateOutput"></div>
            <button onclick="copySwitchTemplate()" style="margin-top: 20px;"><i class="fas fa-copy"></i> Copy Template</button>
        </div>
    </div>

    <!-- Main Reporting Container -->
    <div class="container" id="reporting" style="display: none;">
        <div class="nested-tabs">
            <div class="nested-tab active" onclick="showNestedTab('attendance')">Attendance Report</div>
            <div class="nested-tab" onclick="showNestedTab('report')">Report Generator</div>
            <div class="nested-tab" onclick="showNestedTab('intradayTraffic')">Intraday Traffic</div>
            <div class="nested-tab" onclick="showNestedTab('outage')">Outage Report</div>
            <div class="nested-tab" onclick="showNestedTab('backlog')">Backlog Template</div>
            <div class="nested-tab" onclick="showNestedTab('tph')">TPH Template</div>
            <!-- Modified TPH Tab for external redirect -->
            <div class="nested-tab" onclick="window.open('https://project-star-ui.github.io/TPH/', '_blank');">TPH (External)</div>
        </div>

        <!-- Attendance Report Content -->
        <div id="attendance-content">
            <label for="attendanceNames">Enter Agent Names (one per line):</label>
            <textarea id="attendanceNames" rows="6" placeholder="e.g. John Doe&#10;Jane Smith&#10;Alex Johnson"></textarea>

            <label for="attendanceShiftSchedule">Select Shift Schedule:</label>
            <select id="attendanceShiftSchedule">
                <option value="8PM">8:00 PM</option>
                <option value="10PM">10:00 PM</option>
                <option value="10:30PM">10:30 PM</option>
                <option value="3AM">3:00 AM</option>
                <option value="5AM">5:00 AM</option>
            </select>

            <button onclick="addAttendanceEntries()"><i class="fas fa-user-check"></i> Add Attendance Entries</button>

            <div class="results" id="attendanceResults">
                <!-- Attendance entries will be dynamically added here -->
            </div>

            <button onclick="generateAttendanceReport()"><i class="fas fa-file-alt"></i> Generate Attendance Report</button>
            <div class="report-output attendance-report-output-container" id="attendanceReportOutput"></div>
            <button onclick="copyAttendanceReport()" style="margin-top: 20px;"><i class="fas fa-copy"></i> Copy Attendance Report</button>
        </div>

        <!-- Report Generator Content -->
        <div id="report-content" style="display: none;">
            <div class="report-input-grid">
                <div class="form-group-inline">
                    <label for="imQueueTasks">IM Queue Waiting:</label>
                    <input type="number" id="imQueueTasks" min="0" value="0" />
                </div>

                <div class="form-group-inline">
                    <label for="imAgentsWorking">IM Agents Working:</label>
                    <input type="number" id="imAgentsWorking" min="0" value="0" />
                </div>

                <div class="form-group-inline">
                    <label for="ticketQueueTasks">Ticket Queue Waiting:</label>
                    <input type="number" id="ticketQueueTasks" min="0" value="0" />
                </div>

                <div class="form-group-inline">
                    <label for="ticketAgentsWorking">Ticket Agents Working:</label>
                    <input type="number" id="ticketAgentsWorking" min="0" value="0" />
                </div>

                <div class="form-group-inline">
                    <label for="agentsOnBreak">Agents on Break:</label>
                    <input type="number" id="agentsOnBreak" min="0" value="0" />
                </div>

                <div class="form-group-inline">
                    <label for="agentsOnLunch">Agents on Lunch:</label>
                    <input type="number" id="agentsOnLunch" min="0" value="0" />
                </div>

                <div class="form-group-inline">
                    <label for="agentsOnCoaching">Agents on Coaching:</label>
                    <input type="number" id="agentsOnCoaching" min="0" value="0" />
                </div>

                <div class="form-group-inline">
                    <label for="agentsOnMeeting">Agents on Meeting:</label>
                    <input type="number" id="agentsOnMeeting" min="0" value="0" />
                </div>

                <div class="form-group-inline">
                    <label for="agentsOnTraining">Agents on Training:</label>
                    <input type="number" id="agentsOnTraining" min="0" value="0" />
                </div>
            </div>

            <button onclick="generateReport()"><i class="fas fa-chart-line"></i> Generate Report</button>
            <button onclick="generateUSTBacklog()"><i class="fas fa-clipboard-list"></i> Generate UST Backlog</button>
            <button onclick="generatePHBacklog()"><i class="fas fa-clipboard-list"></i> Generate PH Backlog</button>
            <button onclick="generateReminder()"><i class="fas fa-bell"></i> Generate Reminder</button>
            <button onclick="generateHandlingCO()"><i class="fas fa-handshake"></i> Generate Handling CO</button>


            <div class="report-output" id="reportOutput"></div>
            <!-- New Copy Button -->
            <button onclick="copyReport()" style="margin-top: 20px;"><i class="fas fa-copy"></i> Copy Report</button>
        </div>

        <!-- Intraday Traffic Content -->
        <div id="intradayTraffic-content" style="display: none;">
            <label for="imInbound">IM Inbound:</label>
            <input type="number" id="imInbound" min="0" value="0" />

            <label for="imForecast">IM Forecast:</label>
            <input type="number" id="imForecast" min="0" value="0" />

            <label for="ticketInbound">Ticket Inbound:</label>
            <input type="number" id="ticketInbound" min="0" value="0" />

            <label for="ticketForecast">Ticket Forecast:</label>
            <input type="number" id="ticketForecast" min="0" value="0" />

            <button onclick="generateIntradayTrafficReport()"><i class="fas fa-traffic-light"></i> Generate Intraday Traffic Report</button>

            <div class="report-output" id="intradayTrafficReportOutput"></div>
            <button onclick="copyIntradayTrafficReport()" style="margin-top: 20px;"><i class="fas fa-copy"></i> Copy Intraday Traffic Report</button>
        </div>

        <!-- Outage Report Content -->
        <div id="outage-content" style="display: none;">
            <label for="outageAccount">Account:</label>
            <select id="outageAccount">
                <option value="ByteDance - USDS">ByteDance - USDS</option>
                <!-- Add more accounts here if needed -->
            </select>

            <label for="outageStartTime">Outage start date and time:</label>
            <input type="datetime-local" id="outageStartTime" />

            <label for="outageAffected">Affected:</label>
            <textarea id="outageAffected" rows="4" placeholder="e.g. All agents, specific queues, specific regions"></textarea>

            <label for="outageSide">Client side/CNX side:</label>
            <select id="outageSide">
                <option value="Client side">Client side</option>
                <option value="CNX side">CNX side</option>
            </select>

            <label for="outageAssistCustomer">Can we still assist customer:</label>
            <select id="outageAssistCustomer">
                <option value="Yes">Yes</option>
                <option value="No">No</option>
            </select>

            <label for="outageB2PAffecting">B2P affecting, yes or no:</label>
            <select id="outageB2PAffecting">
                <option value="Yes">Yes</option>
                <option value="No">No</option>
            </select>

            <label for="outageDescription">Short description of the outage:</label>
            <textarea id="outageDescription" rows="4" placeholder="e.g. IM queue is down, login issues"></textarea>

            <label for="outageStatus">Status:</label>
            <select id="outageStatus">
                <option value="Ongoing">Ongoing</option>
                <option value="Resolved">Resolved</option>
                <option value="Investigating">Investigating</option>
                <option value="Monitoring">Monitoring</option>
                <option value="Escalated">Escalated</option>
            </select>

            <button onclick="generateOutageReport()"><i class="fas fa-exclamation-triangle"></i> Generate Outage Report</button>

            <div class="report-output" id="outageReportOutput"></div>
            <button onclick="copyOutageReport()" style="margin-top: 20px;"><i class="fas fa-copy"></i> Copy Outage Report</button>
        </div>

        <!-- Backlog Template Content -->
        <div id="backlog-content" style="display: none;">
            <label for="backlogType">SPS Backlog Update:</label>
            <select id="backlogType" onchange="generateBacklogTemplate()">
                <option value="startDay">Start Day</option>
                <option value="intraday" selected>Intraday</option>
            </select>

            <label for="imHighVolume">Is IM high Volume?</label>
            <select id="imHighVolume" onchange="generateBacklogTemplate()">
                <option value="yes">Yes</option>
                <option value="no">No</option>
            </select>

            <div class="backlog-output" id="backlogTemplateOutput">
                <p id="backlogTitle" style="font-weight: bold;"></p>

                <div class="backlog-time-input-group">
                    <label for="mnlHourInput">MNL Time:</label>
                    <input type="number" id="mnlHourInput" min="0" max="23" value="0" onchange="updateBacklogTimes()">
                    <span>:00</span>
                    <span id="mnlDateDisplay"></span>
                </div>

                <div class="backlog-time-input-group">
                    <label for="usHourInput">US Time:</label>
                    <input type="number" id="usHourInput" min="0" max="23" value="0" onchange="updateBacklogTimes()">
                    <span>:00</span>
                </div>

                <p id="nextReporting"></p>
                <p id="imQueueStatus"></p> <!-- New element for IM Queue status -->
                <h3 style="text-align: center;">BACKLOGS MONITORING</h3>
                <p id="backlogAdditionalText" style="margin-top: 20px;"></p>
            </div>
            <button onclick="copyBacklogTemplate()" style="margin-top: 20px;"><i class="fas fa-copy"></i> Copy Backlog Template</button>
        </div>

        <!-- TPH Template Content -->
        <div id="tph-content" style="display: none;">
            <button onclick="generateTPHTemplate()"><i class="fas fa-hourglass-half"></i> Generate TPH Template</button>
            <div class="report-output" id="tphTemplateOutput"></div>
            <button onclick="copyTPHTemplate()" style="margin-top: 20px;"><i class="fas fa-copy"></i> Copy TPH Template</button>
        </div>
    </div>

    <audio id="breakSound" src="audio/notif.mp3" preload="auto"></audio>

    <!-- Toast Notification Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Clear All Data Button -->
    <button class="clear-all-button" onclick="clearAllData()"><i class="fas fa-eraser"></i> Clear All Saved Data</button>

    <script>
        let generatedScheduleSections = []; // For IM Tasks
        let allAttendanceEntries = [];
        // New object to store the collapse state of attendance sections
        let attendanceSectionCollapseStates = {};
        let allAgentConfigs = []; // New array to store agent configurations

        const shiftOrder = {
            "8PM": 1, "10PM": 2, "10:30PM": 3, "3AM": 4, "5AM": 5
        };

        const attendanceStatuses = [
            "Present",
            "Running late / Advised halfday", // Moved up for easier handling of lates
            "Weather/Calamity", "Health", "NCNS", "Personal reason", "For Attrition/AWOL",
            "Unapproved Absence", "Family Event",
            "Childcare/Kincare", "Bereavement", "Family Emergency", "For Validation",
            "Sick leave", "Transportation", "Unauthorized absence"
        ];

        // Options for the new dropdowns in Agent Configuration
        const breakActivityOptions = [
            "First break",
            "Second break",
            "Lunch",
            "Meeting",
            "Coaching",
            "Other"
        ];

        // Templates for the new "Switch Template" tab
        const switchTemplates = {
            "IM": [
                "Transferring you back to IM. Thanks!",
                "Routing you back to IM. Thanks!",
                "Moving you back to IM. Thanks!",
                "Sending you back over to IM. Thanks!",
                "Switching you over to IM. Thanks!"
            ],
            "Ticket": [
                "Transferring you back to ticket. Thanks!",
                "Routing you back to ticket. Thanks!",
                "Moving you back to ticket. Thanks!",
                "Sending you back over to ticket. Thanks!",
                "Switching you over to ticket. Thanks!"
            ],
            "Break": [
                "Transfering you back to IM after break. Thanks!",
                "Switching you to IM after break. Thanks!",
                "Sending you back to IM after break. Thanks!",
                "Routing you back to IM after break. Thanks!",
                "Moving you to IM after break. Thanks!"
            ],
            "Lunch": [
                "Transfering you back to IM after lunch. Thanks!",
                "Switching you to IM after lunch. Thanks!",
                "Sending you back to IM after lunch. Thanks!",
                "Routing you back to IM after break. Thanks!",
                "Moving you to IM after lunch. Thanks!"
            ]
        };

        // --- Local Storage Keys ---
        const LS_KEYS = {
            IM_AGENTS: 'imAgents',
            IM_TASK_COUNT: 'imTaskCount',
            IM_SHIFT_SCHEDULE: 'imShiftSchedule',
            IM_GENERATED_SECTIONS: 'imGeneratedSections',
            REPORT_INPUTS: 'reportInputs',
            ATTENDANCE_NAMES: 'attendanceNames',
            ATTENDANCE_SHIFT_SCHEDULE: 'attendanceShiftSchedule',
            ATTENDANCE_ENTRIES: 'attendanceEntries',
            ATTENDANCE_COLLAPSE_STATES: 'attendanceCollapseStates',
            OUTAGE_INPUTS: 'outageInputs',
            INTRADAY_TRAFFIC_INPUTS: 'intradayTrafficInputs',
            AGENT_CONFIGS: 'agentConfigs',
            BACKLOG_TYPE: 'backlogType',
            BACKLOG_IM_HIGH_VOLUME: 'backlogImHighVolume', // New key for IM high volume
            BACKLOG_MNL_HOUR: 'backlogMnlHour',
            BACKLOG_US_HOUR: 'backlogUsHour',
            TPH_TEMPLATE_OUTPUT: 'tphTemplateOutput' // New key for TPH template
        };

        // --- Toast Notification System ---
        function showToast(message, type = 'info') {
            const toastContainer = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            let icon = '';
            let displayDuration = 3000; // Default duration

            if (type === 'success') {
                icon = '<i class="fas fa-check-circle"></i>';
            } else if (type === 'error') {
                icon = '<i class="fas fa-times-circle"></i>';
            } else if (type === 'info') {
                icon = '<i class="fas fa-info-circle"></i>';
            } else if (type === 'break-alarm') { // Specific handling for break alarms
                icon = '<i class="fas fa-bell"></i>'; // Bell icon for alarms
                displayDuration = 8000; // Longer display for alarms
            }

            toast.innerHTML = `${icon} <span>${message}</span>`;
            toastContainer.appendChild(toast);

            // Trigger reflow to restart animation
            void toast.offsetWidth;

            toast.style.opacity = 1;
            toast.style.transform = 'translateY(0)';

            // Set animation duration dynamically
            toast.style.animation = `toastIn 0.5s forwards, toastOut 0.5s forwards ${displayDuration / 1000}s`;


            setTimeout(() => {
                toast.style.opacity = 0;
                toast.style.transform = 'translateY(20px)';
                toast.addEventListener('transitionend', () => toast.remove(), { once: true });
            }, displayDuration);
        }

        // --- Local Storage Functions ---
        function saveToLocalStorage(key, data) {
            try {
                localStorage.setItem(key, JSON.stringify(data));
            } catch (e) {
                console.error(`Error saving to local storage for key "${key}":`, e);
                showToast("Failed to save data. Local storage might be full or unavailable.", 'error');
            }
        }

        function loadFromLocalStorage(key) {
            try {
                const data = localStorage.getItem(key);
                return data ? JSON.parse(data) : null;
            } catch (e) {
                console.error(`Error loading from local storage for key "${key}":`, e);
                showToast("Failed to load saved data. Local storage might be corrupted.", 'error');
                return null;
            }
        }

        function clearLocalStorage(key) {
            try {
                localStorage.removeItem(key);
            } catch (e) {
                console.error(`Error clearing local storage for key "${key}":`, e);
                showToast("Failed to clear data. Local storage might be unavailable.", 'error');
            }
        }

        // --- Data Persistence Logic ---

        // Save input fields on change
        function setupInputPersistence() {
            // IM Tasks
            document.getElementById('agents').addEventListener('input', () => saveToLocalStorage(LS_KEYS.IM_AGENTS, document.getElementById('agents').value));
            document.getElementById('taskCount').addEventListener('input', () => saveToLocalStorage(LS_KEYS.IM_TASK_COUNT, document.getElementById('taskCount').value));
            document.getElementById('shiftSchedule').addEventListener('change', () => saveToLocalStorage(LS_KEYS.IM_SHIFT_SCHEDULE, document.getElementById('shiftSchedule').value));

            // Report Generator
            const reportInputs = document.querySelectorAll('#report-content .report-input-grid input[type="number"]');
            reportInputs.forEach(input => {
                input.addEventListener('input', () => {
                    const values = {};
                    reportInputs.forEach(i => values[i.id] = i.value);
                    saveToLocalStorage(LS_KEYS.REPORT_INPUTS, values);
                });
            });

            // Attendance Report
            document.getElementById('attendanceNames').addEventListener('input', () => saveToLocalStorage(LS_KEYS.ATTENDANCE_NAMES, document.getElementById('attendanceNames').value));
            document.getElementById('attendanceShiftSchedule').addEventListener('change', () => saveToLocalStorage(LS_KEYS.ATTENDANCE_SHIFT_SCHEDULE, document.getElementById('attendanceShiftSchedule').value));
            // attendanceEntries and attendanceCollapseStates are saved/loaded in their respective functions

            // Outage Report
            const outageInputs = document.querySelectorAll('#outage-content select, #outage-content input, #outage-content textarea');
            outageInputs.forEach(input => {
                input.addEventListener('input', () => {
                    const values = {};
                    outageInputs.forEach(i => values[i.id] = i.value);
                    saveToLocalStorage(LS_KEYS.OUTAGE_INPUTS, values);
                });
                input.addEventListener('change', () => { // For select elements
                    const values = {};
                    outageInputs.forEach(i => values[i.id] = i.value);
                    saveToLocalStorage(LS_KEYS.OUTAGE_INPUTS, values);
                });
            });

            // Intraday Traffic
            const intradayTrafficInputs = document.querySelectorAll('#intradayTraffic-content input[type="number"]');
            intradayTrafficInputs.forEach(input => {
                input.addEventListener('input', () => {
                    const values = {};
                    intradayTrafficInputs.forEach(i => values[i.id] = i.value);
                    saveToLocalStorage(LS_KEYS.INTRADAY_TRAFFIC_INPUTS, values);
                });
            });

            // Agent Configuration (Break Schedule)
            // allAgentConfigs is saved/loaded in its respective functions

            // Backlog Template
            document.getElementById('backlogType').addEventListener('change', () => {
                saveToLocalStorage(LS_KEYS.BACKLOG_TYPE, document.getElementById('backlogType').value);
                generateBacklogTemplate(); // Regenerate to update times based on new type
            });
            document.getElementById('imHighVolume').addEventListener('change', () => {
                saveToLocalStorage(LS_KEYS.BACKLOG_IM_HIGH_VOLUME, document.getElementById('imHighVolume').value);
                generateBacklogTemplate(); // Regenerate to update text based on new selection
            });
            document.getElementById('mnlHourInput').addEventListener('input', () => saveToLocalStorage(LS_KEYS.BACKLOG_MNL_HOUR, document.getElementById('mnlHourInput').value));
            document.getElementById('usHourInput').addEventListener('input', () => saveToLocalStorage(LS_KEYS.BACKLOG_US_HOUR, document.getElementById('usHourInput').value));

            // TPH Template
            // The TPH template output is generated on demand, but we can save its last generated state
            // if needed. For now, it's generated fresh each time the button is clicked.
        }

        // Load input fields on page load
        function loadInputPersistence() {
            // IM Tasks
            document.getElementById('agents').value = loadFromLocalStorage(LS_KEYS.IM_AGENTS) || '';
            document.getElementById('taskCount').value = loadFromLocalStorage(LS_KEYS.IM_TASK_COUNT) || '';
            document.getElementById('shiftSchedule').value = loadFromLocalStorage(LS_KEYS.IM_SHIFT_SCHEDULE) || '8PM';
            generatedScheduleSections = loadFromLocalStorage(LS_KEYS.IM_GENERATED_SECTIONS) || [];
            if (generatedScheduleSections.length > 0) {
                // Re-render IM tasks from saved data
                sortAndRenderSchedules();
            }

            // Report Generator
            const savedReportInputs = loadFromLocalStorage(LS_KEYS.REPORT_INPUTS);
            if (savedReportInputs) {
                for (const id in savedReportInputs) {
                    const input = document.getElementById(id);
                    if (input) input.value = savedReportInputs[id];
                }
            }

            // Attendance Report
            document.getElementById('attendanceNames').value = loadFromLocalStorage(LS_KEYS.ATTENDANCE_NAMES) || '';
            document.getElementById('attendanceShiftSchedule').value = loadFromLocalStorage(LS_KEYS.ATTENDANCE_SHIFT_SCHEDULE) || '8PM';
            allAttendanceEntries = loadFromLocalStorage(LS_KEYS.ATTENDANCE_ENTRIES) || [];
            attendanceSectionCollapseStates = loadFromLocalStorage(LS_KEYS.ATTENDANCE_COLLAPSE_STATES) || {};
            if (allAttendanceEntries.length > 0) {
                sortAndRenderAttendanceSections(); // Re-render attendance entries
            }

            // Outage Report
            const savedOutageInputs = loadFromLocalStorage(LS_KEYS.OUTAGE_INPUTS);
            if (savedOutageInputs) {
                for (const id in savedOutageInputs) {
                    const input = document.getElementById(id);
                    if (input) input.value = savedOutageInputs[id];
                }
            }

            // Intraday Traffic
            const savedIntradayTrafficInputs = loadFromLocalStorage(LS_KEYS.INTRADAY_TRAFFIC_INPUTS);
            if (savedIntradayTrafficInputs) {
                for (const id in savedIntradayTrafficInputs) {
                    const input = document.getElementById(id);
                    if (input) input.value = savedIntradayTrafficInputs[id];
                }
            }

            // Agent Configuration (Break Schedule)
            allAgentConfigs = loadFromLocalStorage(LS_KEYS.AGENT_CONFIGS) || [];
            if (allAgentConfigs.length > 0) {
                renderAgentConfigs(); // Re-render agent configurations
            }

            // Backlog Template
            document.getElementById('backlogType').value = loadFromLocalStorage(LS_KEYS.BACKLOG_TYPE) || 'intraday';
            document.getElementById('imHighVolume').value = loadFromLocalStorage(LS_KEYS.BACKLOG_IM_HIGH_VOLUME) || 'yes';
            // The generateBacklogTemplate() call in DOMContentLoaded will handle initial display and time updates
            // If specific hour persistence is desired, this logic would need adjustment.
            // document.getElementById('mnlHourInput').value = loadFromLocalStorage(LS_KEYS.BACKLOG_MNL_HOUR) || document.getElementById('mnlHourInput').value;
            // document.getElementById('usHourInput').value = loadFromLocalStorage(LS_KEYS.BACKLOG_US_HOUR) || document.getElementById('usHourInput').value;

            // TPH Template
            document.getElementById('tphTemplateOutput').innerText = loadFromLocalStorage(LS_KEYS.TPH_TEMPLATE_OUTPUT) || '';
        }


        // --- Main Tab Switching with Animation ---
        function showMainTab(tabId) {
            const mainContainers = ['activities', 'reporting'];
            mainContainers.forEach(id => {
                const container = document.getElementById(id);
                if (id === tabId) {
                    container.style.display = 'block';
                    setTimeout(() => {
                        container.style.opacity = 1;
                        container.style.transform = 'translateY(0)';
                    }, 50);
                } else {
                    container.style.opacity = 0;
                    container.style.transform = 'translateY(20px)';
                    container.addEventListener('transitionend', function handler() {
                        if (container.style.opacity === '0') {
                            container.style.display = 'none';
                        }
                        container.removeEventListener('transitionend', handler);
                    }, { once: true });
                }
            });

            const tabs = document.querySelectorAll('.tabs .tab');
            tabs.forEach(t => t.classList.remove('active'));
            Array.from(tabs).find(t => t.textContent.toLowerCase().includes(tabId)).classList.add('active');

            // For Activities and Reporting, show the first nested tab by default
            if (tabId === 'activities') {
                showNestedTab('tasks');
            } else if (tabId === 'reporting') {
                showNestedTab('attendance');
            }
        }

        // --- Nested Tab Switching with Animation ---
        function showNestedTab(tabId) {
            const activitiesContent = ['tasks-content', 'agentConfig-content', 'switchTemplate-content'];
            const reportingContent = ['attendance-content', 'report-content', 'intradayTraffic-content', 'outage-content', 'backlog-content', 'tph-content'];

            let currentContentGroup = [];
            if (activitiesContent.includes(`${tabId}-content`)) {
                currentContentGroup = activitiesContent;
            } else if (reportingContent.includes(`${tabId}-content`)) {
                currentContentGroup = reportingContent;
            }

            currentContentGroup.forEach(id => {
                const contentDiv = document.getElementById(id);
                if (contentDiv) {
                    if (id === `${tabId}-content`) {
                        contentDiv.style.display = 'block';
                        setTimeout(() => {
                            contentDiv.style.opacity = 1;
                            contentDiv.style.transform = 'translateY(0)';
                        }, 50);
                    } else {
                        contentDiv.style.opacity = 0;
                        contentDiv.style.transform = 'translateY(20px)';
                        contentDiv.addEventListener('transitionend', function handler() {
                            if (contentDiv.style.opacity === '0') {
                                contentDiv.style.display = 'none';
                            }
                            contentDiv.removeEventListener('transitionend', handler);
                        }, { once: true });
                    }
                }
            });

            // Update active class for nested tabs
            const nestedTabs = document.querySelectorAll('.nested-tabs .nested-tab');
            nestedTabs.forEach(t => t.classList.remove('active'));
            // Special handling for TPH (External) tab since it's a direct link and doesn't have a content div
            Array.from(nestedTabs).find(t => {
                const text = t.textContent.toLowerCase();
                if (tabId === 'tasks' && text.includes('im tasks')) return true;
                if (tabId === 'agentConfig' && text.includes('break schedule')) return true;
                if (tabId === 'switchTemplate' && text.includes('switch template')) return true;
                if (tabId === 'attendance' && text.includes('attendance report')) return true;
                if (tabId === 'report' && text.includes('report generator')) return true;
                if (tabId === 'intradayTraffic' && text.includes('intraday traffic')) return true;
                if (tabId === 'outage' && text.includes('outage report')) return true;
                if (tabId === 'backlog' && text.includes('backlog template')) return true;
                if (tabId === 'tph' && text.includes('tph template')) return true;
                return false;
            })?.classList.add('active');


            // Specific actions for certain tabs when shown
            if (tabId === 'backlog') {
                generateBacklogTemplate();
            }
        }


        // Initialize first tab with animation
        document.addEventListener('DOMContentLoaded', () => {
            loadInputPersistence(); // Load saved data first
            setupInputPersistence(); // Set up listeners for saving data

            showMainTab('activities'); // Ensure initial main tab is shown with animation
            showNestedTab('tasks'); // Show the first nested tab under Activities

            // --- Add Enter key functionality ---

            // IM Tasks Tab
            document.getElementById('taskCount').addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    event.preventDefault(); // Prevent default form submission
                    generateSkills();
                }
            });
            // Also for the textarea, but only if it's not a new line
            document.getElementById('agents').addEventListener('keydown', function(event) {
                if (event.key === 'Enter' && !event.shiftKey) { // Allow Shift+Enter for new line
                    event.preventDefault();
                    generateSkills();
                }
            });

            // Report Generator Tab
            // Listen to the last input field in the grid
            document.getElementById('agentsOnTraining').addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    event.preventDefault();
                    generateReport();
                }
            });
            // Or, listen to any input in the report grid
            document.querySelectorAll('#report-content .report-input-grid input[type="number"]').forEach(input => {
                input.addEventListener('keypress', function(event) {
                    if (event.key === 'Enter') {
                        event.preventDefault();
                        generateReport();
                    }
                });
            });

            // Attendance Status Tab
            document.getElementById('attendanceNames').addEventListener('keydown', function(event) {
                if (event.key === 'Enter' && !event.shiftKey) { // Allow Shift+Enter for new line
                    event.preventDefault();
                    addAttendanceEntries();
                }
            });

            // Outage Report Tab - Add Enter key functionality for the last input field
            document.getElementById('outageStatus').addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    event.preventDefault();
                    generateOutageReport();
                }
            });

            // Intraday Traffic Tab - Add Enter key functionality for the last input field
            document.getElementById('ticketForecast').addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    event.preventDefault();
                    generateIntradayTrafficReport();
                }
            });

            // Agent Configuration Tab (now Break Schedule)
            document.getElementById('agentConfigNames').addEventListener('keydown', function(event) {
                if (event.key === 'Enter' && !event.shiftKey) { // Allow Shift+Enter for new line
                    event.preventDefault();
                    addAgentConfigEntries();
                }
            });

            // Backlog Template Tab (now nested)
            document.getElementById('usHourInput').addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    event.preventDefault();
                    updateBacklogTimes(); // Or generateBacklogTemplate() if you want to regenerate the whole thing
                }
            });
        });

        // Function to automatically format break time input
        function formatBreakTime(input) {
            let value = input.value.replace(/\D/g, ''); // Remove non-digits
            if (value.length > 2) {
                value = value.substring(0, 2) + ':' + value.substring(2, 4);
            }
            input.value = value;
        }

        function generateSkills() {
            const agentsInput = document.getElementById("agents").value.trim();
            const taskCount = parseInt(document.getElementById("taskCount").value);
            const shiftSchedule = document.getElementById("shiftSchedule").value;
            const resultsDiv = document.getElementById("results");

            if (!agentsInput || isNaN(taskCount) || taskCount < 1) {
                showToast("Please enter valid agent names and task count.", 'error');
                return;
            }

            let agents = agentsInput.split("\n").map(line => {
                const [name, breakTime] = line.split(",").map(item => item.trim());
                return { name, breakTime };
            }).filter(agent => agent.name && agent.breakTime);

            const maxTasksPerAgent = 3;
            const minAgentsRequired = Math.ceil(taskCount / maxTasksPerAgent);

            if (agents.length < minAgentsRequired) {
                showToast(`You need at least ${minAgentsRequired} agents for ${taskCount} tasks.`, 'error');
                return;
            }

            agents.sort((a, b) => b.breakTime.localeCompare(a.breakTime));

            const selectedAgents = agents.slice(0, minAgentsRequired);
            const taskDistribution = {};
            const agentsForExpectations = [];

            for (let i = 0; i < selectedAgents.length; i++) {
                const agent = selectedAgents[i].name;
                taskDistribution[agent] = "will make transfer to IM Queue";
                agentsForExpectations.push(agent);
            }

            const scheduleSection = document.createElement("div");
            scheduleSection.className = "schedule-section";
            const sectionId = `schedule-${Date.now()}`;
            scheduleSection.id = sectionId;
            scheduleSection.setAttribute('data-shift-schedule', shiftSchedule);

            const scheduleHeader = document.createElement("div");
            scheduleHeader.className = "schedule-header";
            scheduleHeader.innerHTML = `
                <span>${shiftSchedule} Shift - IM Assignment & Expectations</span>
                <i class="fas fa-chevron-down"></i>
            `;
            scheduleHeader.onclick = () => toggleCollapse(sectionId);

            const scheduleContent = document.createElement("div");
            scheduleContent.className = "schedule-content";
            scheduleContent.id = `${sectionId}-content`;

            if (agentsForExpectations.length > 0) {
                const expectationsMessageDiv = document.createElement("div");
                expectationsMessageDiv.className = "expectations-message";
                const agentsList = agentsForExpectations.map(agent => `<li>${agent}</li>`).join('');
                expectationsMessageDiv.innerHTML = `<strong>Setting Expectations for ${shiftSchedule} Shift:</strong> The agents listed below will handle IM tasks in sequence if a transfer to the IM queue is needed, with the order arranged according to their break schedules: <ul>${agentsList}</ul>`;
                scheduleContent.appendChild(expectationsMessageDiv);
            }

            const imAssignmentHeader = document.createElement("h3");
            imAssignmentHeader.textContent = "IM Task Assignment";
            imAssignmentHeader.style.color = 'var(--primary-color)';
            imAssignmentHeader.style.marginTop = '20px';
            imAssignmentHeader.style.marginBottom = '15px';
            scheduleContent.appendChild(imAssignmentHeader);

            for (const [agent, message] of Object.entries(taskDistribution)) {
                const div = document.createElement("div");
                div.className = "agent-block";
                div.innerHTML = `<strong>${agent}</strong> <span>- ${message}</span>
                    <button class="done-button" onclick="removeTaskAssignment(this)"><i class="fas fa-check"></i></button>`;
                scheduleContent.appendChild(div);
            }

            scheduleSection.appendChild(scheduleHeader);
            scheduleSection.appendChild(scheduleContent);

            generatedScheduleSections.push({
                id: sectionId,
                shift: shiftSchedule,
                expectations: agentsForExpectations,
                assignments: taskDistribution
            });
            saveToLocalStorage(LS_KEYS.IM_GENERATED_SECTIONS, generatedScheduleSections);

            sortAndRenderSchedules();
            showToast("IM Assignment generated successfully!", 'success');
        }

        function sortAndRenderSchedules() {
            const resultsDiv = document.getElementById("results");
            resultsDiv.innerHTML = "";

            generatedScheduleSections.sort((a, b) => {
                const shiftA = a.shift;
                const shiftB = b.shift;
                return (shiftOrder[shiftA] || Infinity) - (shiftOrder[b] || Infinity);
            });

            generatedScheduleSections.forEach(sectionData => {
                const scheduleSection = document.createElement("div");
                scheduleSection.className = "schedule-section";
                scheduleSection.id = sectionData.id;
                scheduleSection.setAttribute('data-shift-schedule', sectionData.shift);

                const scheduleHeader = document.createElement("div");
                scheduleHeader.className = "schedule-header";
                scheduleHeader.innerHTML = `
                    <span>${sectionData.shift} Shift - IM Assignment & Expectations</span>
                    <i class="fas fa-chevron-down"></i>
                `;
                scheduleHeader.onclick = () => toggleCollapse(sectionData.id);

                const scheduleContent = document.createElement("div");
                scheduleContent.className = "schedule-content";
                scheduleContent.id = `${sectionData.id}-content`;

                if (sectionData.expectations && sectionData.expectations.length > 0) {
                    const expectationsMessageDiv = document.createElement("div");
                    expectationsMessageDiv.className = "expectations-message";
                    const agentsList = sectionData.expectations.map(agent => `<li>${agent}</li>`).join('');
                    expectationsMessageDiv.innerHTML = `<strong>Setting Expectations for ${shiftData.shift} Shift:</strong> The agents listed below will handle IM tasks in sequence if a transfer to the IM queue is needed, with the order arranged according to their break schedules: <ul>${agentsList}</ul>`;
                    scheduleContent.appendChild(expectationsMessageDiv);
                }

                const imAssignmentHeader = document.createElement("h3");
                imAssignmentHeader.textContent = "IM Task Assignment";
                imAssignmentHeader.style.color = 'var(--primary-color)';
                imAssignmentHeader.style.marginTop = '20px';
                imAssignmentHeader.style.marginBottom = '15px';
                scheduleContent.appendChild(imAssignmentHeader);

                for (const [agent, message] of Object.entries(sectionData.assignments)) { /* Corrected: use sectionData.assignments */
                    const div = document.createElement("div");
                    div.className = "agent-block";
                    div.innerHTML = `<strong>${agent}</strong> <span>- ${message}</span>
                        <button class="done-button" onclick="removeTaskAssignment(this, '${sectionData.id}', '${agent}')"><i class="fas fa-check"></i></button>`;
                    scheduleContent.appendChild(div);
                }

                scheduleSection.appendChild(scheduleHeader);
                scheduleSection.appendChild(scheduleContent);
                resultsDiv.appendChild(scheduleSection);
            });
        }

        // Re-using toggleCollapse for both IM Tasks and Attendance Status sections
        function toggleCollapse(sectionId) {
            const header = document.getElementById(sectionId).querySelector('.schedule-header');
            const content = document.getElementById(`${sectionId}-content`);

            // For attendance sections, update the global state
            if (sectionId.startsWith('attendance-schedule-')) {
                const shift = sectionId.replace('attendance-schedule-', '');
                // Toggle the state: if it's currently expanded, it will become collapsed (false), and vice-versa
                attendanceSectionCollapseStates[shift] = !content.classList.contains('expanded');
                saveToLocalStorage(LS_KEYS.ATTENDANCE_COLLAPSE_STATES, attendanceSectionCollapseStates);
            }

            header.classList.toggle('hidden-content');
            content.classList.toggle('expanded');
        }

        function removeTaskAssignment(button, sectionId, agentName) {
            const agentBlock = button.parentElement;
            agentBlock.style.opacity = 0;
            agentBlock.style.transform = 'translateX(-100%)';
            agentBlock.addEventListener('transitionend', () => {
                agentBlock.remove();
                const sectionIndex = generatedScheduleSections.findIndex(s => s.id === sectionId);
                if (sectionIndex !== -1) {
                    delete generatedScheduleSections[sectionIndex].assignments[agentName];
                    if (Object.keys(generatedScheduleSections[sectionIndex].assignments).length === 0) {
                        generatedScheduleSections.splice(sectionIndex, 1);
                    }
                    saveToLocalStorage(LS_KEYS.IM_GENERATED_SECTIONS, generatedScheduleSections);
                    sortAndRenderSchedules();
                }
            }, { once: true });
            showToast("Task assignment removed.", 'info');
        }

        function generateReport() {
            const imQueueWaiting = parseInt(document.getElementById("imQueueTasks").value);
            const imAgentsWorking = parseInt(document.getElementById("imAgentsWorking").value);
            const ticketQueueWaiting = parseInt(document.getElementById("ticketQueueTasks").value);
            const ticketAgentsWorking = parseInt(document.getElementById("ticketAgentsWorking").value);

            const agentsOnBreak = parseInt(document.getElementById("agentsOnBreak").value);
            const agentsOnLunch = parseInt(document.getElementById("agentsOnLunch").value);
            const agentsOnCoaching = parseInt(document.getElementById("agentsOnCoaching").value);
            const agentsOnMeeting = parseInt(document.getElementById("agentsOnMeeting").value);
            const agentsOnTraining = parseInt(document.getElementById("agentsOnTraining").value);

            const reportOutputDiv = document.getElementById("reportOutput");

            const now = new Date();
            const phOffsetMinutes = 8 * 60;
            const localOffsetMinutes = now.getTimezoneOffset();
            const phTimeDate = new Date(now.getTime() + (phOffsetMinutes * 60 * 1000) + (localOffsetMinutes * 60 * 1000));

            let usTimeDate = new Date(phTimeDate.getTime() - (14 * 60 * 60 * 1000));

            usTimeDate.setHours(usTimeDate.getHours() - 1);

            const usHours = String(usTimeDate.getHours()).padStart(2, '0');
            const formattedUsTime = `${usHours}:00`;

            const options = { month: 'long', day: 'numeric', year: 'numeric' };
            const formattedDate = usTimeDate.toLocaleDateString('en-US', options);

            let reportHeader = `As of ${formattedUsTime} (UST) ${formattedDate}.\nUS-BDEE-SPS\n\n`;

            const imAgentText = imAgentsWorking === 1 ? "agent" : "agents";
            const ticketAgentText = ticketAgentsWorking === 1 ? "agent" : "agents";

            let report = reportHeader;
            report += `IM Queue: ${imQueueWaiting} waiting with ${imAgentsWorking} ${imAgentText} working.\n`;
            report += `TK Queue: ${ticketQueueWaiting} waiting with ${ticketAgentsWorking} ${ticketAgentText} working.\n\n`;

            let activityPhrases = [];

            if (agentsOnBreak > 0) {
                activityPhrases.push(`${agentsOnBreak} ${agentsOnBreak === 1 ? 'agent' : 'agents'} on break`);
            }
            if (agentsOnLunch > 0) {
                activityPhrases.push(`${agentsOnLunch} ${agentsOnLunch === 1 ? 'agent' : 'agents'} on lunch`);
            }
            if (agentsOnCoaching > 0) {
                activityPhrases.push(`${agentsOnCoaching} ${agentsOnCoaching === 1 ? 'agent' : 'agents'} in coaching`);
            }
            if (agentsOnMeeting > 0) {
                activityPhrases.push(`${agentsOnMeeting} ${agentsOnMeeting === 1 ? 'agent' : 'agents'} in a meeting`);
            }
            if (agentsOnTraining > 0) {
                activityPhrases.push(`${agentsOnTraining} ${agentsOnTraining === 1 ? 'agent' : 'agents'} attending training`);
            }

            if (activityPhrases.length > 0) {
                let activitySentence = "Right now, we have ";

                if (activityPhrases.length === 1) {
                    activitySentence += `${activityPhrases[0]}.`;
                } else if (activityPhrases.length === 2) {
                    activitySentence += `${activityPhrases[0]} and ${activityPhrases[1]}.`;
                } else {
                    const lastPhrase = activityPhrases.pop();
                    activitySentence += `${activityPhrases.join(', ')}, and ${lastPhrase}.`;
                }
                report += `${activitySentence}\n`;
            }

            reportOutputDiv.innerText = report;
            showToast("Report generated successfully!", 'success');
        }

        function copyReport() {
            const reportText = document.getElementById("reportOutput").innerText;
            if (reportText.trim() === "") {
                showToast("No report to copy. Generate a report first.", 'info');
                return;
            }

            navigator.clipboard.writeText(reportText)
                .then(() => {
                    showToast("Report copied to clipboard!", 'success');
                })
                .catch(err => {
                    console.error('Failed to copy report: ', err);
                    showToast("Failed to copy report. Please try again.", 'error');
                });
        }

        function addAttendanceEntries() {
            const attendanceNamesInput = document.getElementById("attendanceNames").value.trim();
            const shiftSchedule = document.getElementById("attendanceShiftSchedule").value;

            if (!attendanceNamesInput) {
                showToast("Please enter agent name(s).", 'error');
                return;
            }

            const names = attendanceNamesInput.split("\n").map(name => name.trim()).filter(name => name);

            if (names.length === 0) {
                showToast("No valid agent names entered.", 'error');
                return;
            }

            names.forEach(agentName => {
                const entryId = `attendance-entry-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
                allAttendanceEntries.push({
                    id: entryId,
                    name: agentName,
                    status: attendanceStatuses[0],
                    shift: shiftSchedule,
                    loginTime: ''
                });
            });

            saveToLocalStorage(LS_KEYS.ATTENDANCE_ENTRIES, allAttendanceEntries);
            sortAndRenderAttendanceSections();
            showToast("Attendance entries added.", 'success');
            document.getElementById("attendanceNames").value = '';
        }

        function updateAttendanceStatus(entryId, newStatus) {
            const entryIndex = allAttendanceEntries.findIndex(entry => entry.id === entryId);
            if (entryIndex !== -1) {
                allAttendanceEntries[entryIndex].status = newStatus;
                if (newStatus !== "Running late / Advised halfday") {
                    allAttendanceEntries[entryIndex].loginTime = '';
                }
                saveToLocalStorage(LS_KEYS.ATTENDANCE_ENTRIES, allAttendanceEntries);
                showToast(`Status for ${allAttendanceEntries[entryIndex].name} updated to ${newStatus}.`, 'info');
                sortAndRenderAttendanceSections();
            }
        }

        function updateAttendanceLoginTime(entryId, newLoginTime) {
            const entryIndex = allAttendanceEntries.findIndex(entry => entry.id === entryId);
            if (entryIndex !== -1) {
                allAttendanceEntries[entryIndex].loginTime = newLoginTime;
                saveToLocalStorage(LS_KEYS.ATTENDANCE_ENTRIES, allAttendanceEntries);
                showToast(`Login time for ${allAttendanceEntries[entryIndex].name} updated to ${newLoginTime}.`, 'info');
            }
        }

        function deleteAttendance(entryId) {
            const entryIndex = allAttendanceEntries.findIndex(entry => entry.id === entryId);
            if (entryIndex !== -1) {
                const agentName = allAttendanceEntries[entryIndex].name;
                allAttendanceEntries.splice(entryIndex, 1);
                saveToLocalStorage(LS_KEYS.ATTENDANCE_ENTRIES, allAttendanceEntries);
                showToast(`Attendance entry for ${agentName} deleted.`, 'error');
                sortAndRenderAttendanceSections();
            }
        }

        function sortAndRenderAttendanceSections() {
            const attendanceResultsDiv = document.getElementById("attendanceResults");

            const currentSections = attendanceResultsDiv.querySelectorAll('.schedule-section');
            currentSections.forEach(section => {
                const shift = section.getAttribute('data-shift-schedule');
                const content = section.querySelector('.schedule-content');
                attendanceSectionCollapseStates[shift] = content.classList.contains('expanded');
            });
            saveToLocalStorage(LS_KEYS.ATTENDANCE_COLLAPSE_STATES, attendanceSectionCollapseStates);


            attendanceResultsDiv.innerHTML = '';

            const groupedByShift = allAttendanceEntries.reduce((acc, entry) => {
                if (!acc[entry.shift]) {
                    acc[entry.shift] = [];
                }
                acc[entry.shift].push(entry);
                return acc;
            }, {});

            const sortedShifts = Object.keys(groupedByShift).sort((a, b) => {
                return (shiftOrder[a] || Infinity) - (shiftOrder[b] || Infinity);
            });

            sortedShifts.forEach(shift => {
                const shiftEntries = groupedByShift[shift];

                shiftEntries.sort((a, b) => {
                    const statusAIndex = attendanceStatuses.indexOf(a.status);
                    const statusBIndex = attendanceStatuses.indexOf(b.status);
                    if (statusAIndex < statusBIndex) return -1; /* Corrected: statusBBIndex to statusBIndex */
                    if (statusAIndex > statusBIndex) return 1;

                    return a.name.localeCompare(b.name);
                });

                const sectionId = `attendance-schedule-${shift}`;
                const scheduleSection = document.createElement("div");
                scheduleSection.className = "schedule-section";
                scheduleSection.id = sectionId;
                scheduleSection.setAttribute('data-shift-schedule', shift);

                const scheduleHeader = document.createElement("div");
                scheduleHeader.className = "schedule-header";
                scheduleHeader.innerHTML = `
                    <span>${shift} Shift Attendance</span>
                    <i class="fas fa-chevron-down"></i>
                `;
                scheduleHeader.onclick = () => toggleCollapse(sectionId);

                const scheduleContent = document.createElement("div");
                scheduleContent.className = "schedule-content";
                scheduleContent.id = `${sectionId}-content`;

                shiftEntries.forEach(entryData => {
                    const div = document.createElement("div");
                    div.className = "agent-block attendance-entry";
                    div.id = entryData.id;
                    div.setAttribute('data-agent-name', entryData.name);
                    div.setAttribute('data-status', entryData.status);
                    div.setAttribute('data-shift', entryData.shift);

                    let statusOptionsHtml = attendanceStatuses.map(status =>
                        `<option value="${status}" ${status === entryData.status ? 'selected' : ''}>${status}</option>`
                    ).join('');

                    let loginTimeInputHtml = '';
                    if (entryData.status === "Running late / Advised halfday") {
                        loginTimeInputHtml = `
                            <input type="time" value="${entryData.loginTime}"
                                onchange="updateAttendanceLoginTime('${entryData.id}', this.value)"
                                placeholder="Login Time" style="margin-left: 10px; max-width: 120px;">
                        `;
                    }


                    div.innerHTML = `
                        <strong>${entryData.name}</strong>
                        <select onchange="updateAttendanceStatus('${entryData.id}', this.value)">
                            ${statusOptionsHtml}
                        </select>
                        ${loginTimeInputHtml}
                        <div class="actions">
                            <button class="delete-button" onclick="deleteAttendance('${entryData.id}')"><i class="fas fa-trash-alt"></i></button>
                        </div>
                    `;
                    scheduleContent.appendChild(div);
                });

                scheduleSection.appendChild(scheduleHeader);
                scheduleSection.appendChild(scheduleContent);
                attendanceResultsDiv.appendChild(scheduleSection);

                if (attendanceSectionCollapseStates[shift] === true) {
                    scheduleHeader.classList.add('hidden-content');
                    scheduleContent.classList.add('expanded');
                } else if (attendanceSectionCollapseStates[shift] === false) {
                    scheduleHeader.classList.remove('hidden-content');
                    scheduleContent.classList.remove('expanded');
                }
            });
        }

        function generateAttendanceReport() {
            const selectedShift = document.getElementById("attendanceShiftSchedule").value;

            if (allAttendanceEntries.length === 0) {
                showToast("No attendance entries to report.", 'info');
                document.getElementById('attendanceReportOutput').innerHTML = "";
                return;
            }

            const reportHtmlParts = [];
            const shiftData = {};

            const filteredEntries = allAttendanceEntries.filter(entry => entry.shift === selectedShift);

            if (filteredEntries.length === 0) {
                showToast(`No attendance entries found for the ${selectedShift} shift.`, 'info');
                document.getElementById('attendanceReportOutput').innerHTML = "";
                return;
            }

            shiftData[selectedShift] = {
                totalHeadcount: 0,
                presentAgents: [],
                lateAgents: [],
                absentAgents: [],
                totalScheduledHours: 0,
                actualPresentHours: 0
            };

            filteredEntries.forEach(entry => {
                const data = shiftData[entry.shift];
                if (data) {
                    data.totalHeadcount++;
                    data.totalScheduledHours += 8;

                    if (entry.status === "Present") {
                        data.presentAgents.push(entry.name);
                        data.actualPresentHours += 8;
                    } else if (entry.status === "Running late / Advised halfday") {
                        data.lateAgents.push({ name: entry.name, loginTime: entry.loginTime });
                        if (entry.loginTime) {
                            data.actualPresentHours += 7;
                        } else {
                            data.actualPresentHours += 8;
                        }
                    } else {
                        data.absentAgents.push({ name: entry.name, reason: entry.status });
                    }
                }
            });

            const now = new Date();
            const formattedDate = now.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });

            reportHtmlParts.push(`<h3>ATTENDANCE AS OF ${formattedDate.toUpperCase()}</h3>`);
            reportHtmlParts.push("<br>");

            const data = shiftData[selectedShift];
            const totalHeadcount = data.totalHeadcount;
            const presentCount = data.presentAgents.length;
            const lateCount = data.lateAgents.length;
            const absentCount = data.absentAgents.length;

            let attendanceRate = 0;
            let showRate = 0;

            if (totalHeadcount > 0) {
                attendanceRate = (((presentCount + lateCount) / totalHeadcount) * 100).toFixed(2);
            }

            if (data.totalScheduledHours > 0) {
                showRate = ((data.actualPresentHours / data.totalScheduledHours) * 100).toFixed(2);
            }

            reportHtmlParts.push(`<h4>${selectedShift} Shift Performance:</h4>`);
            reportHtmlParts.push(`<ul>`);
            reportHtmlParts.push(`  <li><strong>Total Scheduled Headcount:</strong> ${totalHeadcount} agents</li>`);
            reportHtmlParts.push(`  <li><strong>Agents Present:</strong> ${presentCount}</li>`);
            reportHtmlParts.push(`  <li><strong>Agents Running Late:</strong> ${lateCount}</li>`);
            reportHtmlParts.push(`  <li><strong>Agents Absent:</strong> ${absentCount}</li>`);
            reportHtmlParts.push(`  <li><strong>Attendance Rate:</strong> ${attendanceRate}% (Based on agents present or late vs. total headcount)</li>`);
            reportHtmlParts.push(`  <li><strong>Show Rate:</strong> ${showRate}% (Based on actual productive hours vs. total scheduled hours)</li>`);
            reportHtmlParts.push(`</ul>`);

            if (data.presentAgents.length > 0) {
                reportHtmlParts.push(`  <h5>Details for Present Agents:</h5>`);
                reportHtmlParts.push(`  <ul>`);
                data.presentAgents.sort().forEach(agentName => {
                    reportHtmlParts.push(`    <li>${agentName}</li>`);
                });
                reportHtmlParts.push(`  </ul>`);
            }

            if (data.lateAgents.length > 0) {
                reportHtmlParts.push(`  <h5>Details for Late Agents:</h5>`);
                reportHtmlParts.push(`  <ul>`);
                data.lateAgents.sort((a, b) => a.name.localeCompare(b.name)).forEach(agent => {
                    reportHtmlParts.push(`    <li>${agent.name} (Actual Login: ${agent.loginTime || 'Not Provided'})</li>`);
                });
                reportHtmlParts.push(`  </ul>`);
            }

            if (data.absentAgents.length > 0) {
                reportHtmlParts.push(`  <h5>Details for Absent Agents:</h5>`);
                reportHtmlParts.push(`  <ul>`);
                data.absentAgents.sort((a, b) => a.name.localeCompare(b.name)).forEach(agent => {
                    reportHtmlParts.push(`    <li>${agent.name} (Reason: ${agent.reason})</li>`);
                });
                reportHtmlParts.push(`  </ul>`);
            }
            reportHtmlParts.push(`<br>`);


            document.getElementById('attendanceReportOutput').innerHTML = reportHtmlParts.join('\n');
            showToast("RTA Attendance Report generated!", 'success');
        }


        function copyAttendanceReport() {
            const reportOutputDiv = document.getElementById("attendanceReportOutput");
            const tempTextArea = document.createElement('textarea');
            let reportText = '';

            reportOutputDiv.querySelectorAll('h3, p, h4, h5, ul, li').forEach(element => {
                if (element.tagName === 'H3' || element.tagName === 'P') {
                    reportText += element.textContent.trim() + '\n\n';
                } else if (element.tagName === 'H4') {
                    reportText += `--- ${element.textContent.trim()} ---\n\n`;
                } else if (element.tagName === 'H5') {
                    reportText += `  ${element.textContent.trim()}\n`;
                } else if (element.tagName === 'LI') {
                    let indent = '';
                    let parent = element.parentElement;
                    while (parent && parent !== reportOutputDiv) {
                        if (parent.tagName === 'UL') {
                            indent += '  ';
                        }
                        parent = parent.parentElement;
                    }
                    reportText += `${indent}- ${element.textContent.trim()}\n`;
                }
            });

            tempTextArea.value = reportText.trim();

            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextArea);
            showToast("Attendance Report copied to clipboard!", 'success');
        }

        function generateOutageReport() {
            const account = document.getElementById('outageAccount').value;
            const startTime = document.getElementById('outageStartTime').value;
            const affected = document.getElementById('outageAffected').value.trim();
            const side = document.getElementById('outageSide').value;
            const assistCustomer = document.getElementById('outageAssistCustomer').value;
            const b2pAffecting = document.getElementById('outageB2PAffecting').value;
            const description = document.getElementById('outageDescription').value.trim();
            const status = document.getElementById('outageStatus').value;

            if (!account || !startTime || !affected || !side || !assistCustomer || !b2pAffecting || !description || !status) {
                showToast("Please fill in all fields for the Outage Report.", 'error');
                return;
            }

            let formattedStartTime = '';
            try {
                const dateObj = new Date(startTime);
                formattedStartTime = dateObj.toLocaleString('en-US', {
                    year: 'numeric', month: 'long', day: 'numeric',
                    hour: '2-digit', minute: '2-digit', second: '2-digit',
                    hour12: true
                });
            } catch (e) {
                formattedStartTime = startTime;
            }

            const reportText = `
Account: ${account}
Outage start date and time: ${formattedStartTime}
Affected: ${affected}
Client side/CNX side: ${side}
Can we still assist customer: ${assistCustomer}
B2P affecting, yes or no: ${b2pAffecting}
Short description of the outage: ${description}
Status: ${status}
            `.trim();

            document.getElementById('outageReportOutput').innerText = reportText;
            showToast("Outage Report generated successfully!", 'success');
        }

        function copyOutageReport() {
            const reportText = document.getElementById("outageReportOutput").innerText;
            if (reportText.trim() === "") {
                showToast("No Outage Report to copy. Generate a report first.", 'info');
                return;
            }

            navigator.clipboard.writeText(reportText)
                .then(() => {
                    showToast("Outage Report copied to clipboard!", 'success');
                })
                .catch(err => {
                    console.error('Failed to copy outage report: ', err);
                    showToast("Failed to copy outage report. Please try again.", 'error');
                });
        }

        function generateUSTBacklog() {
            const reportOutputDiv = document.getElementById("reportOutput");
            const now = new Date();

            const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
            let ustTimeDate = new Date(utc + (-6 * 3600000));

            ustTimeDate.setHours(ustTimeDate.getHours() - 1);

            const usHours = String(ustTimeDate.getHours()).padStart(2, '0');
            const formattedUstTime = `${usHours}:00`;

            const options = { month: 'long', day: 'numeric', year: 'numeric' };
            const formattedDate = ustTimeDate.toLocaleDateString('en-US', options);

            const report = `Backlogs as of ${formattedUstTime} (UST) | ${formattedDate}.

We have already advised the agents to prioritize open, assigned, and reviewing pending and on-hold tickets that have been aging for more than five days.`;

            reportOutputDiv.innerText = report;
            showToast("UST Backlog Report generated!", 'success');
        }

        function generatePHBacklog() {
            const reportOutputDiv = document.getElementById("reportOutput");
            const now = new Date();

            const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
            const phTimeDate = new Date(utc + (8 * 3600000));

            const phHours = phTimeDate.getHours();
            const ampm = phHours >= 12 ? 'PM' : 'AM';
            const displayHour = phHours % 12 === 0 ? 12 : phHours % 12;
            const formattedPhHour = `${displayHour}${ampm}`;

            const options = { month: 'long', day: 'numeric', year: 'numeric' };
            const formattedDate = phTimeDate.toLocaleDateString('en-US', options);

            const report = `Backlogs as of ${formattedPhHour} | ${formattedDate}.`;

            reportOutputDiv.innerText = report;
            showToast("PH Backlog Report generated!", 'success');
        }

        function generateReminder() {
            const reportOutputDiv = document.getElementById("reportOutput");
            const reminderText = `Hi Team,

Kindly check all Pending, Onhold, Assigned, and Open tickets. Please prioritize those that have been Pending for more than 5 days.

PENDING

OPEN

ONHOLD

ASSIGNED`;

            reportOutputDiv.innerText = reminderText;
            showToast("Reminder generated!", 'success');
        }

        function generateHandlingCO() {
            const reportOutputDiv = document.getElementById("reportOutput");
            const handlingCOText = `Please check your current handling and prioritize your tasks if youre on the list below. Focus especially on those with higher handling times or pending tasks.`;

            reportOutputDiv.innerText = handlingCOText;
            showToast("Handling CO message generated!", 'success');
        }

        function generateIntradayTrafficReport() {
            const imInbound = parseInt(document.getElementById("imInbound").value);
            const imForecast = parseInt(document.getElementById("imForecast").value);
            const ticketInbound = parseInt(document.getElementById("ticketInbound").value);
            const ticketForecast = parseInt(document.getElementById("ticketForecast").value);
            const reportOutputDiv = document.getElementById("intradayTrafficReportOutput");

            if (isNaN(imInbound) || isNaN(imForecast) || isNaN(ticketInbound) || isNaN(ticketForecast)) {
                showToast("Please enter valid numbers for all fields.", 'error');
                return;
            }

            const now = new Date();
            now.setDate(now.getDate() - 1);
            const options = { month: 'long', day: 'numeric', year: 'numeric' };
            const formattedDate = now.toLocaleDateString('en-US', options);

            let imPercentage = 0;
            let imComparisonText = "";
            if (imForecast > 0) {
                imPercentage = ((imInbound / imForecast) * 100).toFixed(0);
                if (imInbound > imForecast) {
                    imComparisonText = `- Today, we've seen ${imInbound} inbound IMs, which is well over ${Math.round(imInbound / imForecast)} times our forecast of ${imForecast}.
 - This ${imPercentage}% over-delivery is putting significant strain on our IM team, causing agents to operate at full capacity and potentially leading to longer wait times for our customers.`;
                } else if (imInbound < imForecast) {
                    imComparisonText = `- Today, we've seen ${imInbound} inbound IMs, which is below our forecast of ${imForecast}.
 - This ${imPercentage}% delivery means we currently have capacity to handle more volume.`;
                } else {
                    imComparisonText = `- Today, we've seen ${imInbound} inbound IMs, which is exactly our forecast of ${imForecast}.
 - This ${imPercentage}% delivery indicates stable volume.
`;
                }
            } else {
                imComparisonText = `- Today, we've seen ${imInbound} inbound IMs, with no forecast provided.`;
            }

            let ticketPercentage = 0;
            let ticketComparisonText = "";
            if (ticketForecast > 0) {
                ticketPercentage = ((ticketInbound / ticketForecast) * 100).toFixed(0);
                if (ticketInbound > ticketForecast) {
                    ticketComparisonText = `- Ticket volume is also up, with ${ticketInbound} inbound tickets, compared to a forecast of ${ticketForecast}.
 - That's a ${ticketPercentage}% increase, leading to the backlog we're currently addressing.
 - Because ticket handling takes more time per case, even this relatively smaller volume spike has a significant impact on the overall workload.`;
                } else if (ticketInbound < ticketForecast) {
                    ticketComparisonText = `- Ticket volume is also down, with ${ticketInbound} inbound tickets, compared to a forecast of ${ticketForecast}.
 - That's a ${ticketPercentage}% delivery, indicating lower than expected volume.`;
                } else {
                    ticketComparisonText = `- Ticket volume is stable, with ${ticketInbound} inbound tickets, exactly matching our forecast of ${ticketForecast}.
 - That's a ${ticketPercentage}% delivery, indicating stable volume.`;
                }
            } else {
                ticketComparisonText = `- Ticket volume is ${ticketInbound} inbound tickets, with no forecast provided.`;
            }

            const report = `Hi @All!

Heres a quick update on our intraday traffic as of ${formattedDate}:

IM Queue
${imComparisonText}

Ticket Queue
${ticketComparisonText}

What Were Doing
 - Our priority remains keeping the IM queue as responsive as possible. Were monitoring closely and adjusting coverage in real time.
 - For tickets, we are prioritizing tickets assigned for over 5 days and focusing on clearing those to reduce backlog impact.`;

            reportOutputDiv.innerText = report;
            showToast("Intraday Traffic Report generated!", 'success');
        }

        function copyIntradayTrafficReport() {
            const reportText = document.getElementById("intradayTrafficReportOutput").innerText;
            if (reportText.trim() === "") {
                showToast("No Intraday Traffic Report to copy. Generate a report first.", 'info');
                return;
            }

            navigator.clipboard.writeText(reportText)
                .then(() => {
                    showToast("Intraday Traffic Report copied to clipboard!", 'success');
                })
                .catch(err => {
                    console.error('Failed to copy intraday traffic report: ', err);
                    showToast("Failed to copy intraday traffic report. Please try again.", 'error');
                });
        }

        function generateSwitchTemplate(templateType) {
            const templates = switchTemplates[templateType];
            if (!templates || templates.length === 0) {
                document.getElementById('switchTemplateOutput').innerText = "No templates available for this type.";
                showToast("No templates available.", 'info');
                return;
            }

            const randomIndex = Math.floor(Math.random() * templates.length);
            const selectedTemplate = templates[randomIndex];

            document.getElementById('switchTemplateOutput').innerText = selectedTemplate;
            showToast(`Generated ${templateType} template!`, 'success');
        }

        function copySwitchTemplate() {
            const templateText = document.getElementById("switchTemplateOutput").innerText;
            if (templateText.trim() === "") {
                showToast("No template to copy. Generate a template first.", 'info');
                return;
            }

            navigator.clipboard.writeText(templateText)
                .then(() => {
                    showToast("Template copied to clipboard!", 'success');
                })
                .catch(err => {
                    console.error('Failed to copy template: ', err);
                    showToast("Failed to copy template. Please try again.", 'error');
                });
        }

        function addAgentConfigEntries() {
            const agentNamesInput = document.getElementById('agentConfigNames').value.trim();
            if (!agentNamesInput) {
                showToast("Please enter agent name(s).", 'error');
                return;
            }

            const names = agentNamesInput.split("\n").map(name => name.trim()).filter(name => name);

            if (names.length === 0) {
                showToast("No valid agent names entered.", 'error');
                return;
            }

            names.forEach(agentName => {
                const existingAgent = allAgentConfigs.find(config => config.name === agentName);
                if (existingAgent) {
                    showToast(`Agent "${agentName}" already exists.`, 'info');
                    return;
                }

                const entryId = `agent-config-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
                allAgentConfigs.push({
                    id: entryId,
                    name: agentName,
                    breakSlots: []
                });
            });

            saveToLocalStorage(LS_KEYS.AGENT_CONFIGS, allAgentConfigs);
            renderAgentConfigs();
            document.getElementById('agentConfigNames').value = '';
            showToast("Agent(s) added to configuration.", 'success');
        }

        function addBreakSlot(agentId) {
            const agentIndex = allAgentConfigs.findIndex(config => config.id === agentId);
            if (agentIndex !== -1) {
                if (allAgentConfigs[agentIndex].breakSlots.length < 6) {
                    allAgentConfigs[agentIndex].breakSlots.push({
                        type: breakActivityOptions[0],
                        time: ''
                    });
                    saveToLocalStorage(LS_KEYS.AGENT_CONFIGS, allAgentConfigs);
                    renderAgentConfigs();
                    showToast("Break/Activity slot added.", 'info');
                } else {
                    showToast("Maximum 6 break/activity slots per agent.", 'info');
                }
            }
        }

        function updateBreakSlot(agentId, slotIndex, field, value) {
            const agentIndex = allAgentConfigs.findIndex(config => config.id === agentId);
            if (agentIndex !== -1 && allAgentConfigs[agentIndex].breakSlots[slotIndex]) {
                allAgentConfigs[agentIndex].breakSlots[slotIndex][field] = value;
                saveToLocalStorage(LS_KEYS.AGENT_CONFIGS, allAgentConfigs);
                if (field === 'time') {
                    const agentName = allAgentConfigs[agentIndex].name;
                    const slot = allAgentConfigs[agentIndex].breakSlots[slotIndex];
                    const slotAlarmId = `${agentId}-slot-container-${slotIndex}`;
                    setBreakAlarmAgentConfig(agentName, slot.type, slot.time, slotAlarmId);
                }
                showToast(`Break/Activity updated for ${allAgentConfigs[agentIndex].name}.`, 'info');
            }
        }

        function removeBreakSlot(agentId, slotIndex) {
            const agentIndex = allAgentConfigs.findIndex(config => config.id === agentId);
            if (agentIndex !== -1 && allAgentConfigs[agentIndex].breakSlots[slotIndex]) {
                allAgentConfigs[agentIndex].breakSlots.splice(slotIndex, 1);
                saveToLocalStorage(LS_KEYS.AGENT_CONFIGS, allAgentConfigs);
                renderAgentConfigs();
                showToast("Break/Activity slot removed.", 'info');
            }
        }

        function deleteAgentConfig(entryId) {
            const entryIndex = allAgentConfigs.findIndex(config => config.id === entryId);
            if (entryIndex !== -1) {
                const agentName = allAgentConfigs[entryIndex].name;
                allAgentConfigs.splice(entryIndex, 1);
                saveToLocalStorage(LS_KEYS.AGENT_CONFIGS, allAgentConfigs);
                renderAgentConfigs();
                showToast(`Agent "${agentName}" removed from configuration.`, 'error');
            }
        }

        function renderAgentConfigs() {
            const agentConfigResultsDiv = document.getElementById('agentConfigResults');
            agentConfigResultsDiv.innerHTML = '';

            allAgentConfigs.sort((a, b) => a.name.localeCompare(b.name));

            allAgentConfigs.forEach(config => {
                const div = document.createElement('div');
                div.className = 'agent-config-entry';
                div.id = config.id;

                let breakSlotsHtml = config.breakSlots.map((slot, index) => {
                    let optionsHtml = breakActivityOptions.map(option =>
                        `<option value="${option}" ${option === slot.type ? 'selected' : ''}>${option}</option>`
                    ).join('');
                    const slotContainerId = `${config.id}-slot-container-${index}`;
                    // Set alarm for existing slots when rendering
                    if (slot.time) {
                        setBreakAlarmAgentConfig(config.name, slot.type, slot.time, slotContainerId);
                    }
                    return `
                        <div class="break-slot-container" id="${slotContainerId}">
                            <select onchange="updateBreakSlot('${config.id}', ${index}, 'type', this.value)">
                                ${optionsHtml}
                            </select>
                            <input type="text" placeholder="HH:MM" value="${slot.time}"
                                oninput="formatBreakTime(this); updateBreakSlot('${config.id}', ${index}, 'time', this.value)"
                                pattern="([01]?[0-9]|2[0-3]):[0-5][0-9]" maxlength="5" />
                            <button class="remove-slot-button" onclick="removeBreakSlot('${config.id}', ${index})"><i class="fas fa-minus-circle"></i></button>
                        </div>
                    `;
                }).join('');

                div.innerHTML = `
                    <strong>${config.name}</strong>
                    ${breakSlotsHtml}
                    <button class="add-slot-button" onclick="addBreakSlot('${config.id}')"><i class="fas fa-plus-circle"></i> Add Break/Activity Slot</button>
                    <div class="actions">
                        <button class="delete-button" onclick="deleteAgentConfig('${config.id}')"><i class="fas fa-trash-alt"></i> Delete Agent</button>
                    </div>
                `;
                agentConfigResultsDiv.appendChild(div);
            });
        }

        function setBreakAlarmAgentConfig(agentName, breakType, breakTime, slotContainerId) {
            // Clear any existing alarm for this slot to prevent duplicates
            clearTimeout(window[`alarmTimeout_${slotContainerId}`]);

            const now = new Date();
            const breakDate = new Date();
            const [hours, minutes] = breakTime.split(':');

            if (!hours || !minutes) {
                // If time is not set or invalid, just clear any existing alarm and return
                return;
            }

            breakDate.setHours(parseInt(hours), parseInt(minutes), 0, 0);

            // Set alarm 35 minutes before the actual break time
            const alarmTime = new Date(breakDate.getTime() - (35 * 60 * 1000));

            // If the alarm time has already passed for today, schedule it for tomorrow
            if (alarmTime < now) {
                alarmTime.setDate(alarmTime.getDate() + 1);
            }

            const timeUntilAlarm = alarmTime - now;

            const formatDisplayTime = (time24hr) => {
                const [h, m] = time24hr.split(':');
                let hours = parseInt(h);
                const minutes = parseInt(m);
                const ampm = hours >= 12 ? 'PM' : 'AM';
                hours = hours % 12;
                hours = hours ? hours : 12; // the hour '0' should be '12'
                const strMinutes = minutes < 10 ? '0' + minutes : minutes;
                return `${hours}:${strMinutes} ${ampm}`;
            };

            if (timeUntilAlarm > 0) {
                window[`alarmTimeout_${slotContainerId}`] = setTimeout(() => {
                    const breakSound = document.getElementById("breakSound");
                    if (breakSound) {
                        breakSound.play().catch(e => console.error("Error playing sound:", e));
                    }
                    showToast(`${agentName}'s ${breakType.toLowerCase()} is in 35 minutes! (${formatDisplayTime(breakTime)})`, 'break-alarm');

                    const slotContainer = document.getElementById(slotContainerId);
                    if (slotContainer) {
                        slotContainer.style.borderLeftColor = 'orange';
                        slotContainer.style.boxShadow = '0 5px 15px rgba(255, 165, 0, 0.5)';
                    }

                    // Schedule the visual change for when the actual break time arrives
                    const actualBreakTime = new Date();
                    actualBreakTime.setHours(parseInt(hours), parseInt(minutes), 0, 0);
                    if (actualBreakTime < now) { // If actual break time already passed today, consider it for tomorrow
                        actualBreakTime.setDate(actualBreakTime.getDate() + 1);
                    }
                    const timeUntilActualBreak = actualBreakTime - new Date();

                    if (timeUntilActualBreak > 0) {
                        setTimeout(() => {
                            const slotContainer = document.getElementById(slotContainerId);
                            if (slotContainer) {
                                slotContainer.style.opacity = '0.6';
                                slotContainer.style.borderLeftColor = '#607d8b'; /* Greyed out */
                                slotContainer.style.boxShadow = '0 2px 8px rgba(0,0,0,0.2)';
                                slotContainer.querySelectorAll('select, input, button').forEach(el => {
                                    el.style.display = 'none';
                                });
                                const completedText = document.createElement('span');
                                completedText.textContent = `${breakType} at ${formatDisplayTime(breakTime)} - COMPLETED`;
                                completedText.style.color = 'var(--text-color)';
                                completedText.style.fontWeight = 'bold';
                                slotContainer.prepend(completedText);
                            }
                        }, timeUntilActualBreak);
                    } else {
                        // If actual break time has already passed, mark as completed immediately
                        const slotContainer = document.getElementById(slotContainerId);
                        if (slotContainer) {
                            slotContainer.style.opacity = '0.6';
                            slotContainer.style.borderLeftColor = '#607d8b';
                            slotContainer.style.boxShadow = '0 2px 8px rgba(0,0,0,0.2)';
                            slotContainer.querySelectorAll('select, input, button').forEach(el => {
                                el.style.display = 'none';
                            });
                            const completedText = document.createElement('span');
                            completedText.textContent = `${breakType} at ${formatDisplayTime(breakTime)} - COMPLETED`;
                            completedText.style.color = 'var(--text-color)';
                            completedText.style.fontWeight = 'bold';
                            slotContainer.prepend(completedText);
                        }
                    }

                }, timeUntilAlarm);
            } else {
                // If alarm time has already passed, mark as completed immediately
                const slotContainer = document.getElementById(slotContainerId);
                if (slotContainer) {
                    slotContainer.style.opacity = '0.6';
                    slotContainer.style.borderLeftColor = '#607d8b';
                    slotContainer.style.boxShadow = '0 2px 8px rgba(0,0,0,0.2)';
                    slotContainer.querySelectorAll('select, input, button').forEach(el => {
                        el.style.display = 'none';
                    });
                    const completedText = document.createElement('span');
                    completedText.textContent = `${breakType} at ${formatDisplayTime(breakTime)} - COMPLETED`;
                    completedText.style.color = 'var(--text-color)';
                    completedText.style.fontWeight = 'bold';
                    slotContainer.prepend(completedText);
                }
            }
        }

        function generateBacklogTemplate() {
            const backlogType = document.getElementById('backlogType').value;
            const imHighVolume = document.getElementById('imHighVolume').value; // Get the new dropdown value
            const backlogTitleElem = document.getElementById('backlogTitle');
            const mnlHourInput = document.getElementById('mnlHourInput');
            const mnlDateDisplay = document.getElementById('mnlDateDisplay');
            const usHourInput = document.getElementById('usHourInput');
            const nextReportingElem = document.getElementById('nextReporting');
            const imQueueStatusElem = document.getElementById('imQueueStatus'); // New element for IM Queue status
            const backlogAdditionalTextElem = document.getElementById('backlogAdditionalText');

            // Update backlog title
            if (backlogType === 'startDay') {
                backlogTitleElem.textContent = "SPS Backlog update (Start Day)";
            } else {
                backlogTitleElem.textContent = "SPS Backlog update (Intraday)";
            }

            // Update IM Queue status based on imHighVolume selection
            if (imHighVolume === 'yes') {
                imQueueStatusElem.textContent = `As a professional RTA, I'd like to provide an update on our current situation. We're experiencing a high volume of messages in our IM queue, and our team is diligently working to balance the distribution across both IM and ticket queues to ensure efficient handling. We are also actively prioritizing 3-5 day unassigned and assigned tickets to prevent further aging. Your continued focus on these priorities is greatly appreciated.`;
            } else {
                imQueueStatusElem.textContent = `As a professional RTA, I'd like to provide an update on our current situation. While we're not currently experiencing an exceptionally high volume of messages in our IM queue, our team is continuously balancing the distribution across both IM and ticket queues to maintain efficiency. We are also actively prioritizing 3-5 day unassigned and assigned tickets to prevent further aging. Your continued focus on these priorities is greatly appreciated.`;
            }

            // Set the additional text for the backlog template
            backlogAdditionalTextElem.textContent = `
IM QUEUE

BACKLOGS
            `;


            const now = new Date();

            const mnlOptions = {
                hour: '2-digit',
                hour12: false,
                timeZone: 'Asia/Manila',
                month: 'long',
                day: 'numeric',
                year: 'numeric'
            };
            const mnlFormatter = new Intl.DateTimeFormat('en-US', mnlOptions);
            const mnlParts = mnlFormatter.formatToParts(now);
            const mnlHour = parseInt(mnlParts.find(p => p.type === 'hour').value);
            const mnlMonth = mnlParts.find(p => p.type === 'month').value;
            const mnlDay = mnlParts.find(p => p.type === 'day').value;
            const mnlYear = mnlParts.find(p => p.type === 'year').value;

            mnlHourInput.value = mnlHour;
            mnlDateDisplay.textContent = `- ${mnlMonth} ${mnlDay}, ${mnlYear}`;

            const usOptions = {
                hour: '2-digit',
                hour12: false,
                timeZone: 'America/Chicago'
            };
            const usFormatter = new Intl.DateTimeFormat('en-US', usOptions);
            const usParts = usFormatter.formatToParts(now);
            let usHour = parseInt(usParts.find(p => p.type === 'hour').value);

            usHour = (usHour - 2 + 24) % 24; // Adjusting for a specific offset, if needed. Original code had this.

            usHourInput.value = usHour;

            let nextReportingHour = (parseInt(usHourInput.value) + 1) % 24;
            const nextReportingFormatted = String(nextReportingHour).padStart(2, '0');
            nextReportingElem.textContent = `Next reporting: ${nextReportingFormatted}:00 UST`;

            saveToLocalStorage(LS_KEYS.BACKLOG_TYPE, backlogType);
            saveToLocalStorage(LS_KEYS.BACKLOG_IM_HIGH_VOLUME, imHighVolume); // Save new dropdown value
            saveToLocalStorage(LS_KEYS.BACKLOG_MNL_HOUR, mnlHourInput.value);
            saveToLocalStorage(LS_KEYS.BACKLOG_US_HOUR, usHourInput.value);

            showToast(`Backlog template for ${backlogType === 'startDay' ? 'Start Day' : 'Intraday'} generated!`, 'success');
        }

        function updateBacklogTimes() {
            const usHourInput = document.getElementById('usHourInput');
            const nextReportingElem = document.getElementById('nextReporting');
            const mnlHourInput = document.getElementById('mnlHourInput');

            let currentUsHour = parseInt(usHourInput.value);
            if (isNaN(currentUsHour) || currentUsHour < 0 || currentUsHour > 23) {
                currentUsHour = 0;
                usHourInput.value = 0;
            }

            let nextReportingHour = (currentUsHour + 1) % 24;
            const nextReportingFormatted = String(nextReportingHour).padStart(2, '0');
            nextReportingElem.textContent = `Next reporting: ${nextReportingFormatted}:00 UST`;

            saveToLocalStorage(LS_KEYS.BACKLOG_MNL_HOUR, mnlHourInput.value);
            saveToLocalStorage(LS_KEYS.BACKLOG_US_HOUR, usHourInput.value);
        }


        function copyBacklogTemplate() {
            const backlogOutputDiv = document.getElementById('backlogTemplateOutput');
            const tempTextArea = document.createElement('textarea');

            const mnlHour = document.getElementById('mnlHourInput').value;
            const mnlDate = document.getElementById('mnlDateDisplay').textContent.trim().substring(2);
            const usHour = document.getElementById('usHourInput').value;
            const nextReporting = document.getElementById('nextReporting').textContent;
            const imQueueStatus = document.getElementById('imQueueStatus').textContent.trim(); // Get IM Queue status
            const backlogAdditionalText = document.getElementById('backlogAdditionalText').textContent.trim();

            tempTextArea.value = `${document.getElementById('backlogTitle').textContent}\n` +
                                 `MNL Time: ${String(mnlHour).padStart(2, '0')}:00 ${mnlDate}\n` +
                                 `US Time: ${String(usHour).padStart(2, '0')}:00\n` +
                                 `${nextReporting}\n\n` +
                                 `${imQueueStatus}\n\n` + // Include IM Queue status
                                 `${backlogAdditionalText}\n\n` +
                                 `BACKLOGS MONITORING`; // Add "BACKLOGS MONITORING" at the end

            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextArea);
            showToast("Backlog template copied to clipboard!", 'success');
        }

        function generateTPHTemplate() {
            const tphOutputDiv = document.getElementById("tphTemplateOutput");

            const now = new Date();
            const phTime = new Date(now.toLocaleString("en-US", { timeZone: "Asia/Manila" }));

            const phDateOptions = { month: 'long', day: 'numeric', year: 'numeric' };
            const formattedPhDate = phTime.toLocaleDateString('en-US', phDateOptions);

            const phHour = phTime.getHours();
            const ampm = phHour >= 12 ? 'PM' : 'AM';
            const displayHour = phHour % 12 === 0 ? 12 : phHour % 12;
            const formattedPhTime = `${displayHour} ${ampm}`;

            const template = `Hi @All, heres your current running TPH as of ${formattedPhDate}, ${formattedPhTime}. Please continue with your ticket handling to help us stay on track. We appreciate your efforts!

TPH Summary:


TPH Per Hour:
`;
            tphOutputDiv.innerText = template;
            saveToLocalStorage(LS_KEYS.TPH_TEMPLATE_OUTPUT, template); // Save the generated template
            showToast("TPH Template generated successfully!", 'success');
        }

        function copyTPHTemplate() {
            const tphText = document.getElementById("tphTemplateOutput").innerText;
            if (tphText.trim() === "") {
                showToast("No TPH template to copy. Generate a template first.", 'info');
                return;
            }

            navigator.clipboard.writeText(tphText)
                .then(() => {
                    showToast("TPH Template copied to clipboard!", 'success');
                })
                .catch(err => {
                    console.error('Failed to copy TPH template: ', err);
                    showToast("Failed to copy TPH template. Please try again.", 'error');
                });
        }

        function clearAllData() {
            if (confirm("Are you sure you want to clear ALL saved data? This action cannot be undone.")) {
                localStorage.clear();

                document.getElementById('agents').value = '';
                document.getElementById('taskCount').value = '';
                document.getElementById('shiftSchedule').value = '8PM';
                document.getElementById('results').innerHTML = '';
                generatedScheduleSections = [];

                document.getElementById('imQueueTasks').value = '0';
                document.getElementById('imAgentsWorking').value = '0';
                document.getElementById('ticketQueueTasks').value = '0';
                document.getElementById('ticketAgentsWorking').value = '0';
                document.getElementById('agentsOnBreak').value = '0';
                document.getElementById('agentsOnLunch').value = '0';
                document.getElementById('agentsOnCoaching').value = '0';
                document.getElementById('agentsOnMeeting').value = '0';
                document.getElementById('agentsOnTraining').value = '0';
                document.getElementById('reportOutput').innerText = '';

                document.getElementById('attendanceNames').value = '';
                document.getElementById('attendanceShiftSchedule').value = '8PM';
                document.getElementById('attendanceResults').innerHTML = '';
                document.getElementById('attendanceReportOutput').innerHTML = '';
                allAttendanceEntries = [];
                attendanceSectionCollapseStates = {};

                document.getElementById('outageAccount').value = 'ByteDance - USDS';
                document.getElementById('outageStartTime').value = '';
                document.getElementById('outageAffected').value = '';
                document.getElementById('outageSide').value = 'Client side';
                document.getElementById('outageAssistCustomer').value = 'Yes';
                document.getElementById('outageB2PAffecting').value = 'Yes';
                document.getElementById('outageDescription').value = '';
                document.getElementById('outageStatus').value = 'Ongoing';
                document.getElementById('outageReportOutput').innerText = '';

                document.getElementById('imInbound').value = '0';
                document.getElementById('imForecast').value = '0';
                document.getElementById('ticketInbound').value = '0';
                document.getElementById('ticketForecast').value = '0';
                document.getElementById('intradayTrafficReportOutput').innerText = '';

                document.getElementById('switchTemplateOutput').innerText = '';

                document.getElementById('agentConfigNames').value = '';
                document.getElementById('agentConfigResults').innerHTML = '';
                allAgentConfigs = [];

                document.getElementById('backlogType').value = 'intraday';
                document.getElementById('imHighVolume').value = 'yes'; // Reset new dropdown
                generateBacklogTemplate(); // Re-initialize to default values
                document.getElementById('backlogTemplateOutput').innerHTML = '';

                document.getElementById('tphTemplateOutput').innerText = ''; // Clear TPH output

                showToast("All saved data has been cleared!", 'success');
            }
        }
    </script>
</body>
</html>
